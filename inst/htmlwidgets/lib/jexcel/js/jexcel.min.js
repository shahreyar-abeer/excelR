if(!jSuites&&"function"==typeof require){var jSuites=require("jsuites");require("jsuites/dist/jsuites.css")}!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.jexcel=e()}(this,function(){"use strict";var _Mathmax=Math.max,_Mathmin=Math.min,_Mathlog=Math.log,_Mathsin=Math.sin,_Mathexp=Math.exp,_Mathcos=Math.cos,_Mathatan=Math.atan,_MathPI=Math.PI,_Mathsqrt=Math.sqrt,_Mathabs=Math.abs,_Mathfloor=Math.floor,_Mathround=Math.round,_Mathpow=Math.pow,_StringfromCharCode=String.fromCharCode,_Mathceil=Math.ceil,jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("JEXCEL: el is not a valid DOM element"),!1;var defaults={url:null,data:null,copyCompatibility:!1,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jexcel",csvHeaders:!0,csvDelimiter:",",selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,meta:null,style:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,onundo:null,onredo:null,onload:null,onchange:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,updateTable:null,detachForUpdates:!1,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:"jExcel CE Spreadsheet\nVersion 3.9.1\nAuthor: Paul Hodel <paul.hodel@gmail.com>\nWebsite: https://bossanova.uk/jexcel/v3"};for(var property in defaults)if(!(options&&options.hasOwnProperty(property)))obj.options[property]=defaults[property];else if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("JEXCEL: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(t){null==t&&(t=!obj.options.fullscreen),obj.options.fullscreen!=t&&(obj.options.fullscreen=t,1==t?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&void 0!==obj.options.data[0]){var s=Object.keys(obj.options.data[0]);s.length>n&&(n=s.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var t=[],o=0;o<n;o++)obj.options.colHeaders[o]||(obj.options.colHeaders[o]=""),obj.options.colWidths[o]||(obj.options.colWidths[o]=obj.options.defaultColWidth),obj.options.colAlignments[o]||(obj.options.colAlignments[o]=obj.options.defaultColAlign),obj.options.columns[o]?obj.options.columns[o].type||(obj.options.columns[o].type="text"):obj.options.columns[o]={type:"text"},obj.options.columns[o].name||(obj.options.columns[o].name=s&&s[o]?s[o]:o),obj.options.columns[o].source||(obj.options.columns[o].source=[]),obj.options.columns[o].options||(obj.options.columns[o].options=[]),obj.options.columns[o].editor||(obj.options.columns[o].editor=null),obj.options.columns[o].allowEmpty||(obj.options.columns[o].allowEmpty=!1),obj.options.columns[o].title||(obj.options.columns[o].title=obj.options.colHeaders[o]?obj.options.colHeaders[o]:""),obj.options.columns[o].width||(obj.options.columns[o].width=obj.options.colWidths[o]?obj.options.colWidths[o]:obj.options.defaultColWidth),obj.options.columns[o].align||(obj.options.columns[o].align=obj.options.colAlignments[o]?obj.options.colAlignments[o]:"center"),"autocomplete"==obj.options.columns[o].type||"dropdown"==obj.options.columns[o].type?obj.options.columns[o].url&&t.push(jSuites.ajax({url:obj.options.columns[o].url,index:o,method:"GET",dataType:"json",multiple:t,success:function(n){for(var e=0;e<n.length;e++)obj.options.columns[this.index].source.push(n[e])},complete:function(){obj.createTable()}})):"calendar"==obj.options.columns[o].type&&(obj.options.columns[o].options.format||(obj.options.columns[o].options.format="DD/MM/YYYY"));t.length||obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var d=document.createElement("div"),e=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),d.appendChild(e),d.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var t=document.createElement("div"),r;if(0<obj.options.pagination&&obj.options.paginationOptions&&0<obj.options.paginationOptions.length){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var p=0,g;p<obj.options.paginationOptions.length;p++)g=document.createElement("option"),g.value=obj.options.paginationOptions[p],g.innerHTML=obj.options.paginationOptions[p],obj.paginationDropdown.appendChild(g);t.appendChild(document.createTextNode(obj.options.text.show)),t.appendChild(obj.paginationDropdown),t.appendChild(document.createTextNode(obj.options.text.entries))}if(obj.filter=document.createElement("div"),obj.filter.classList.add("jexcel_filter"),obj.filter.appendChild(t),obj.filter.appendChild(d),obj.colgroupContainer=document.createElement("colgroup"),(r=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(r),obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var m=0;m<obj.options.nestedHeaders.length;m++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[m]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(r=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(r),p=0;p<obj.options.columns.length;p++)obj.createCellHeader(p),obj.headerContainer.appendChild(obj.headers[p]),obj.colgroupContainer.appendChild(obj.colgroup[p]);obj.thead.appendChild(obj.headerContainer),obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.setAttribute("onselectstart","return false"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var h=document.createElement("a");if(h.setAttribute("href","https://bossanova.uk/jexcel/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about","undefined"!=typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var i=document.createElement("img");i.src="//bossanova.uk/jexcel/logo.png",h.appendChild(i)}var a=document.createElement("span");a.innerHTML="Jexcel spreadsheet",h.appendChild(a),obj.ads.appendChild(h),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var u=document.createElement("div"),c=document.createElement("div");obj.pagination.appendChild(u),obj.pagination.appendChild(c),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(obj.filter),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1)},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:"GET",dataType:"json",success:function(t){obj.options.data=t.data?t.data:t,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(g){if(g&&("string"==typeof g&&(g=JSON.parse(g)),obj.options.data=g),obj.options.data||(obj.options.data=[]),obj.options.data){g=[];for(var m=0;m<obj.options.data.length;m++){for(var h=[],o=0;o<obj.options.columns.length;o++)h[o]=obj.options.data[m][obj.options.columns[o].name];g.push(h)}obj.options.data=g}m=0,o=0;var C=obj.options.columns.length,n=obj.options.data.length,l=obj.options.minDimensions[0],s=obj.options.minDimensions[1],i=l>C?l:C,a=s>n?s:n;for(m=0;m<a;m++)for(o=0;o<i;o++)null==obj.options.data[m]&&(obj.options.data[m]=[]),null==obj.options.data[m][o]&&(obj.options.data[m][o]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading){var u=0,f=100>obj.options.data.length?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("JEXCEL: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,u=obj.options.pagination*obj.pageNumber,f=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<f&&(f=obj.options.data.length)):(u=0,f=obj.options.data.length);for(m=0;m<obj.options.data.length;m++){var y=obj.createRow(m,obj.options.data[m]);m>=u&&m<f&&obj.tbody.appendChild(y)}if(1==obj.options.lazyLoading||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var p=Object.keys(obj.options.mergeCells);for(o=0;o<p.length;o++){var d=obj.options.mergeCells[p[o]];obj.setMerge(p[o],d[0],d[1],1)}}obj.updateTable(),obj.ignoreEvents||"function"==typeof obj.options.onload&&obj.options.onload(el,obj)},obj.getData=function(d,e){for(var t=[],o=0,c=0,p=1==e||0==obj.options.copyCompatibility,l=obj.options.columns.length,s=obj.options.data.length,i=0;i<s;i++){o=0;for(var g=0;g<l;g++)d&&!obj.records[i][g].classList.contains("highlight")||(t[c]||(t[c]=[]),t[c][o]=p?obj.options.data[i][g]:obj.records[i][g].innerHTML,o++);0<o&&c++}return t},obj.getJson=function(i){for(var e=[],t=obj.options.columns.length,o=obj.options.data.length,r=0;r<o;r++){for(var a=null,d=0;d<t;d++)i&&!obj.records[r][d].classList.contains("highlight")||(null==a&&(a={}),a[obj.options.columns[d].name]=obj.options.data[r][d]);null!=a&&e.push(a)}return e},obj.getRowData=function(t){return obj.options.data[t]},obj.setRowData=function(n,e){for(var t=0,s;t<obj.headers.length;t++)s=jexcel.getColumnNameFromId([t,n]),null!=e[t]&&obj.setValue(s,e[t])},obj.getColumnData=function(n){for(var e=[],t=0;t<obj.options.data.length;t++)e.push(obj.options.data[t][n]);return e},obj.setColumnData=function(n,e){for(var t=0,s;t<obj.rows.length;t++)s=jexcel.getColumnNameFromId([n,t]),null!=e[t]&&obj.setValue(s,e[t])},obj.createRow=function(n,e){(obj.records[n]||(obj.records[n]=[]),!e)&&(e=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n),obj.options.rows[n]&&obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height);var r=document.createElement("td");for(r.innerHTML=parseInt(n+1),r.setAttribute("data-y",n),r.className="jexcel_row",obj.rows[n].appendChild(r),i=0;i<obj.options.columns.length;i++)obj.records[n][i]=obj.createCell(i,n,e[i]),obj.rows[n].appendChild(obj.records[n][i]);return obj.rows[n]},obj.createCell=function(d,e,t){var c=document.createElement("td");if(c.setAttribute("data-x",d),c.setAttribute("data-y",e),"hidden"==obj.options.columns[d].type)c.style.display="none",c.innerHTML=t;else if("checkbox"==obj.options.columns[d].type||"radio"==obj.options.columns[d].type){var r=document.createElement("input");r.type=obj.options.columns[d].type,r.name="c"+d,r.checked=1==t||1==t||"true"==t,r.onclick=function(){obj.setValue(c,this.checked)},1==obj.options.columns[d].readOnly&&r.setAttribute("disabled","disabled"),c.appendChild(r),obj.options.data[e][d]=r.checked}else if("calendar"==obj.options.columns[d].type){var n=jSuites.calendar.extractDateFromString(t,obj.options.columns[d].options.format);c.innerHTML=jSuites.calendar.getDateString(n||t,obj.options.columns[d].options.format)}else if("dropdown"==obj.options.columns[d].type||"autocomplete"==obj.options.columns[d].type)c.classList.add("jexcel_dropdown"),c.innerHTML=obj.getDropDownValue(d,t);else if("color"==obj.options.columns[d].type){if("square"==obj.options.columns[d].render){var l=document.createElement("div");l.className="color",l.style.backgroundColor=t,c.appendChild(l)}else c.style.color=t,c.innerHTML=t;}else if("image"!=obj.options.columns[d].type){if("="==(""+t).substr(0,1)&&1==obj.options.parseFormulas&&(t=obj.executeFormula(t,d,e)),obj.options.columns[d].mask){var s=obj.options.columns[d].decimal||".";t=""+jSuites.mask.run(t,obj.options.columns[d].mask,s)}c.innerHTML=t}else if(t&&"data:image"==t.substr(0,10)){var a=document.createElement("img");a.src=t,c.appendChild(a)}1==obj.options.columns[d].readOnly&&(c.className="readonly");var i=obj.options.columns[d].align?obj.options.columns[d].align:"center";return c.style.textAlign=i,0!=obj.options.columns[d].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[d].wordWrap||200<c.innerHTML.length)&&(c.style.whiteSpace="pre-wrap"),0<d&&(t||c.innerHTML?obj.records[e][d-1].style.overflow="hidden":d==obj.options.columns.length-1&&(c.style.overflow="hidden")),c},obj.createCellHeader=function(n){var e=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,t=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=t,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.options.columns[n].title),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",e),"hidden"==obj.options.columns[n].type&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.createNestedHeader=function(a){var e=document.createElement("tr");e.classList.add("jexcel_nested");var t=document.createElement("td");e.appendChild(t);for(var d=0,u=0;u<a.length;u++){a[u].colspan||(a[u].colspan=1),a[u].align||(a[u].align="center"),a[u].title||(a[u].title="");for(var c=a[u].colspan,p=[],s=0;s<c;s++)obj.options.columns[d]&&"hidden"==obj.options.columns[d].type&&c++,p.push(d),d++;(t=document.createElement("td")).setAttribute("data-column",p.join(",")),t.setAttribute("colspan",a[u].colspan),t.setAttribute("align",a[u].align),t.innerHTML=a[u].title,e.appendChild(t)}return e},obj.createToolbar=function(s){s?obj.options.toolbar=s:s=obj.options.toolbar;for(var l=0;l<s.length;l++)if("i"==s[l].type)(d=document.createElement("i")).classList.add("jexcel_toolbar_item"),d.classList.add("material-icons"),d.setAttribute("data-k",s[l].k),d.setAttribute("data-v",s[l].v),s[l].tooltip&&d.setAttribute("title",s[l].tooltip),d.onclick=s[l].onclick&&(s[l].onclick,1)?s[l].onclick:function(){var n=this.getAttribute("data-k"),e=this.getAttribute("data-v");obj.setStyle(obj.highlighted,n,e)},d.innerHTML=s[l].content,obj.toolbar.appendChild(d);else if("select"==s[l].type){(d=document.createElement("select")).classList.add("jexcel_toolbar_item"),d.setAttribute("data-k",s[l].k),s[l].tooltip&&d.setAttribute("title",s[l].tooltip),d.onchange=s[l].onchange&&(s[l].onchange,1)?s[l].onchange:function(){var t=this.getAttribute("data-k");obj.setStyle(obj.highlighted,t,this.value)};for(var i=0,a;i<s[l].v.length;i++)a=document.createElement("option"),a.value=s[l].v[i],a.innerHTML=s[l].v[i],d.appendChild(a);obj.toolbar.appendChild(d)}else if("color"==s[l].type){var d;(d=document.createElement("i")).classList.add("jexcel_toolbar_item"),d.classList.add("material-icons"),d.setAttribute("data-k",s[l].k),d.setAttribute("data-v",""),s[l].tooltip&&d.setAttribute("title",s[l].tooltip),obj.toolbar.appendChild(d),d.onclick=function(){this.color.open()},d.innerHTML=s[l].content,jSuites.color(d,{onchange:function(n,e){var t=n.getAttribute("data-k");obj.setStyle(obj.highlighted,t,e)}})}},obj.setMerge=function(g,m,h,C){var r=!1;if(!g){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var f=parseInt(obj.highlighted[0].getAttribute("data-x")),l=parseInt(obj.highlighted[0].getAttribute("data-y")),s=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),i=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));g=jexcel.getColumnNameFromId([f,l]),m=s-f+1,h=i-l+1}var a=jexcel.getIdFromColumnName(g,!0);if(obj.options.mergeCells[g])obj.records[a[1]][a[0]].getAttribute("data-merged")&&(r=obj.options.text.cellAlreadyMerged);else if((!m||2>m)&&(!h||2>h))r=obj.options.text.invalidMergeProperties;else for(var u=a[1];u<a[1]+h;u++)for(var y=a[0];y<a[0]+m;y++)jexcel.getColumnNameFromId([y,u]),obj.records[u][y].getAttribute("data-merged")&&(r=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(r)alert(r);else{1<m?obj.records[a[1]][a[0]].setAttribute("colspan",m):m=1,1<h?obj.records[a[1]][a[0]].setAttribute("rowspan",h):h=1,obj.options.mergeCells[g]=[m,h,[]],obj.records[a[1]][a[0]].setAttribute("data-merged","true"),obj.records[a[1]][a[0]].style.overflow="hidden";for(var N=[],p=a[1];p<a[1]+h;p++)for(var E=a[0];E<a[0]+m;E++)a[0]==E&&a[1]==p||(N.push(obj.options.data[p][E]),obj.updateCell(E,p,"",!0),obj.options.mergeCells[g][2].push(obj.records[p][E]),obj.records[p][E].style.display="none",obj.records[p][E]=obj.records[a[1]][a[0]]);obj.updateSelection(obj.records[a[1]][a[0]]),C||(obj.setHistory({action:"setMerge",column:g,colspan:m,rowspan:h,data:N}),"function"==typeof obj.options.onmerge&&obj.options.onmerge(el,g,m,h))}},obj.getMerge=function(n){var e={};if(n)e=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var s=Object.keys(obj.options.mergeCells),o=0;o<s.length;o++)e[s[o]]=[obj.options.mergeCells[s[o]][0],obj.options.mergeCells[s[o]][1]]}return e},obj.removeMerge=function(a,e,t){if(obj.options.mergeCells[a]){var o=jexcel.getIdFromColumnName(a,!0);obj.records[o[1]][o[0]].removeAttribute("colspan"),obj.records[o[1]][o[0]].removeAttribute("rowspan"),obj.records[o[1]][o[0]].removeAttribute("data-merged");for(var r=obj.options.mergeCells[a],n=0,d=0;d<r[1];d++)for(var u=0;u<r[0];u++)(0<d||0<u)&&(obj.records[o[1]+d][o[0]+u]=r[2][n],obj.records[o[1]+d][o[0]+u].style.display="",e&&e[n]&&obj.updateCell(o[0]+u,o[1]+d,e[n]),n++);obj.updateSelection(obj.records[o[1]][o[0]],obj.records[o[1]+d-1][o[0]+u-1]),t||delete obj.options.mergeCells[a]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var e=Object.keys(obj.options.mergeCells),t=0;t<e.length;t++)obj.removeMerge(e[t],null,n)}},obj.isColMerged=function(d,e){var t=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++){var u=jexcel.getIdFromColumnName(o[r],!0),l=obj.options.mergeCells[o[r]][0],s=u[0],i=u[0]+(1<l?l-1:0);null==e?s<=d&&i>=d&&t.push(o[r]):e?s<d&&i>=d&&t.push(o[r]):s<=d&&i>d&&t.push(o[r])}return t},obj.isRowMerged=function(d,e){var t=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++){var u=jexcel.getIdFromColumnName(o[r],!0),l=obj.options.mergeCells[o[r]][1],s=u[1],i=u[1]+(1<l?l-1:0);null==e?s<=d&&i>=d&&t.push(o[r]):e?s<d&&i>=d&&t.push(o[r]):s<=d&&i>d&&t.push(o[r])}return t},obj.openEditor=function(d,e,t){var o=d.getAttribute("data-y"),r=d.getAttribute("data-x");obj.ignoreEvents||"function"==typeof obj.options.oneditionstart&&obj.options.oneditionstart(el,d,r,o),0<r&&(obj.records[o][r-1].style.overflow="hidden");var n=function(e){var t=d.getBoundingClientRect(),n=document.createElement(e);return n.style.width=t.width+"px",n.style.height=t.height-2+"px",n.style.minHeight=t.height-2+"px",d.classList.add("editor"),d.innerHTML="",d.appendChild(n),n};if(1==d.classList.contains("readonly"));else if(obj.edition=[obj.records[o][r],obj.records[o][r].innerHTML,r,o],obj.options.columns[r].editor)obj.options.columns[r].editor.openEditor(d,el,e,t);else if("hidden"==obj.options.columns[r].type);else if("checkbox"==obj.options.columns[r].type||"radio"==obj.options.columns[r].type){var l=!d.children[0].checked;obj.setValue(d,l),obj.edition=null}else if("dropdown"==obj.options.columns[r].type||"autocomplete"==obj.options.columns[r].type){if(l=obj.options.data[o][r],"function"==typeof obj.options.columns[r].filter)var p=obj.options.columns[r].filter(el,d,r,o,obj.options.columns[r].source);else p=obj.options.columns[r].source;var g=n("div"),m={data:p,multiple:!!obj.options.columns[r].multiple,autocomplete:obj.options.columns[r].autocomplete||"autocomplete"==obj.options.columns[r].type,opened:!0,value:obj.options.columns[r].multiple?l.split(";"):l,width:"100%",height:g.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(d,!0)}};obj.options.columns[r].options&&obj.options.columns[r].options.type&&(m.type=obj.options.columns[r].options.type),jSuites.dropdown(g,m)}else if("calendar"==obj.options.columns[r].type||"color"==obj.options.columns[r].type)l=obj.options.data[o][r],((g=n("input")).value=l,1!=obj.options.tableOverflow&&1!=obj.options.fullscreen||(obj.options.columns[r].options.position=!0),obj.options.columns[r].options.value=obj.options.data[o][r],obj.options.columns[r].options.opened=!0,obj.options.columns[r].options.onclose=function(){obj.closeEditor(d,!0)},"color"==obj.options.columns[r].type)?jSuites.color(g,obj.options.columns[r].options):jSuites.calendar(g,obj.options.columns[r].options).setValue(l),g.focus();else if("image"==obj.options.columns[r].type){var u=d.children[0];(g=n("div")).style.position="relative";var c=document.createElement("div");c.classList.add("jclose"),u&&u.src&&c.appendChild(u),g.appendChild(c),jSuites.image(c,obj.options.imageOptions);const e=d.getBoundingClientRect(),t=c.getBoundingClientRect();c.style.top=window.innerHeight<e.bottom+t.height?e.top-(t.height+2)+"px":e.top+"px"}else{if(l=1==e?"":obj.options.data[o][r],0==obj.options.columns[r].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[r].wordWrap)g=n("input"),obj.options.columns[r].mask&&g.setAttribute("data-mask",obj.options.columns[r].mask);else var g=n("textarea");g.value=l,g.onblur=function(){obj.closeEditor(d,!0)},g.focus()}},obj.closeEditor=function(s,e){var t=parseInt(s.getAttribute("data-x")),o=parseInt(s.getAttribute("data-y"));if(1==e){if(obj.options.columns[t].editor)var r=obj.options.columns[t].editor.closeEditor(s,e);else if("checkbox"==obj.options.columns[t].type||"radio"==obj.options.columns[t].type||"hidden"==obj.options.columns[t].type);else if("dropdown"==obj.options.columns[t].type||"autocomplete"==obj.options.columns[t].type)r=s.children[0].dropdown.close(!0);else if("calendar"==obj.options.columns[t].type)r=s.children[0].calendar.close(!0);else if("color"==obj.options.columns[t].type)r=s.children[1].color.close(!0);else if("image"==obj.options.columns[t].type){var i=s.children[0].children[0].children[0];r=i&&"IMG"==i.tagName?i.src:""}else"numeric"==obj.options.columns[t].type?("="!=(r=s.children[0].value).substr(0,1)&&""==r&&(r=obj.options.columns[t].allowEmpty?"":0),s.children[0].onblur=null):(r=s.children[0].value,s.children[0].onblur=null);obj.options.data[o][t]==r?s.innerHTML=obj.edition[1]:obj.setValue(s,r)}else obj.options.columns[t].editor?obj.options.columns[t].editor.closeEditor(s,e):"dropdown"==obj.options.columns[t].type||"autocomplete"==obj.options.columns[t].type?s.children[0].dropdown.close(!0):"calendar"==obj.options.columns[t].type?s.children[0].calendar.close(!0):"color"==obj.options.columns[t].type?s.children[1].color.close(!0):s.children[0].onblur=null,s.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.ignoreEvents||"function"==typeof obj.options.oneditionend&&obj.options.oneditionend(el,s,t,o,r,e),s.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var r=(n=jexcel.getIdFromColumnName(n,!0))[0],t=n[1];return obj.records[t][r]},obj.getCellFromCoords=function(n,e){return obj.records[e][n]},obj.getLabel=function(n){var r=(n=jexcel.getIdFromColumnName(n,!0))[0],t=n[1];return obj.records[t][r].innerHTML},obj.getLabelFromCoords=function(n,e){return obj.records[e][n].innerHTML},obj.getValue=function(s,l){if("object"==typeof s)var t=s.getAttribute("data-x"),i=s.getAttribute("data-y");else t=(s=jexcel.getIdFromColumnName(s,!0))[0],i=s[1];var a=null;return null!=t&&null!=i&&(obj.records[i]&&obj.records[i][t]&&(l||1==obj.options.copyCompatibility)?a=obj.records[i][t].innerHTML:obj.options.data[i]&&"undefined"!=obj.options.data[i][t]&&(a=obj.options.data[i][t])),a},obj.getValueFromCoords=function(n,e,t){var o=null;return null!=n&&null!=e&&(obj.records[e]&&obj.records[e][n]&&t||1==obj.options.copyCompatibility?o=obj.records[e][n].innerHTML:obj.options.data[e]&&"undefined"!=obj.options.data[e][n]&&(o=obj.options.data[e][n])),o},obj.setValue=function(d,e,t){var o=[];if("string"==typeof d){var r=(g=jexcel.getIdFromColumnName(d,!0))[0],u=g[1];c=jexcel.getColumnNameFromId([r,u]),obj.setStyle(c,"background","green",null,1),o.push(obj.updateCell(r,u,e,t)),obj.updateFormulaChain(r,u,o)}else if(console.log("else"),r=null,u=null,d&&d.getAttribute&&(r=d.getAttribute("data-x"),u=d.getAttribute("data-y")),null!=r&&null!=u){var c=jexcel.getColumnNameFromId([r,u]);obj.setStyle(c,"background","#3D9970",null,1),o.push({style:!0,cell:c,oldValue:"background:",newValue:"background: green"}),obj.updateFormulaChain(r,u,o),o.push(obj.updateCell(r,u,e,t)),obj.updateFormulaChain(r,u,o)}else{var p=Object.keys(d);if(0<p.length)for(var s=0;s<p.length;s++){if("string"==typeof d[s]){var g;r=(g=jexcel.getIdFromColumnName(d[s],!0))[0],u=g[1]}else r=d[s].getAttribute("data-x"),u=d[s].getAttribute("data-y");var c=jexcel.getColumnNameFromId([r,u]);console.log(c),obj.setStyle(c,"background","#3D9970",null,1),o.push({style:!0,cell:c,oldValue:"background:",newValue:"background: green"}),obj.updateFormulaChain(r,u,o),null!=r&&null!=u&&(o.push(obj.updateCell(r,u,e,t)),obj.updateFormulaChain(r,u,o))}}//r.push({oldValue: "background:", newValue: "background: green"});
console.log(o),obj.setHistory({action:"setValue",records:o,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,o)},obj.setValueFromCoords=function(s,e,t,o){var r=[];r.push(obj.updateCell(s,e,t,o)),obj.updateFormulaChain(s,e,r),obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.setCheckRadioValue=function(){for(var s=[],e=Object.keys(obj.highlighted),t=0;t<e.length;t++){var l=obj.highlighted[t].getAttribute("data-x"),r=obj.highlighted[t].getAttribute("data-y");"checkbox"!=obj.options.columns[l].type&&"radio"!=obj.options.columns[l].type||s.push(obj.updateCell(l,r,!obj.options.data[r][l]))}s.length&&(obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell}),obj.onafterchanges(el,s))},obj.updateCell=function(d,e,t,p){if(1!=obj.records[e][d].classList.contains("readonly")||p){if(!obj.ignoreEvents&&"function"==typeof obj.options.onbeforechange){var r=obj.options.onbeforechange(el,obj.records[e][d],d,e,t);null!=r&&(t=r)}if(a={x:d,y:e,col:d,row:e,newValue:t,oldValue:obj.options.data[e][d]},obj.options.columns[d].editor)obj.options.data[e][d]=t,obj.options.columns[d].editor.setValue(obj.records[e][d],t,p);else if("checkbox"==obj.options.columns[d].type||"radio"==obj.options.columns[d].type){if("radio"==obj.options.columns[d].type)for(var n=0;n<obj.options.data.length;n++)obj.options.data[n][d]=!1;obj.records[e][d].children[0].checked=1==t||1==t||"true"==t||"TRUE"==t,obj.options.data[e][d]=obj.records[e][d].children[0].checked}else if("dropdown"==obj.options.columns[d].type||"autocomplete"==obj.options.columns[d].type)obj.options.data[e][d]=t,obj.records[e][d].innerHTML=obj.getDropDownValue(d,t);else if("calendar"==obj.options.columns[d].type){var g=jSuites.calendar.extractDateFromString(t,obj.options.columns[d].options.format);obj.options.data[e][d]=t,obj.records[e][d].innerHTML=jSuites.calendar.getDateString(g||t,obj.options.columns[d].options.format)}else if("color"==obj.options.columns[d].type){if(obj.options.data[e][d]=t,"square"==obj.options.columns[d].render){var s=document.createElement("div");s.className="color",s.style.backgroundColor=t,obj.records[e][d].innerHTML="",obj.records[e][d].appendChild(s)}else obj.records[e][d].style.color=t,obj.records[e][d].innerHTML=t;}else if("image"!=obj.options.columns[d].type){if(obj.options.data[e][d]=t,"="==(""+t).substr(0,1)&&1==obj.options.parseFormulas&&(t=obj.executeFormula(t,d,e)),obj.options.columns[d].mask){var i=obj.options.columns[d].decimal||".";t=""+jSuites.mask.run(t,obj.options.columns[d].mask,i)}obj.records[e][d].innerHTML=t,obj.records[e][d].style.whiteSpace=0!=obj.options.columns[d].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[d].wordWrap||200<obj.records[e][d].innerHTML.length)?"pre-wrap":""}else if(t=""+t,obj.options.data[e][d]=t,obj.records[e][d].innerHTML="",t&&"data:image"==t.substr(0,10)){var u=document.createElement("img");u.src=t,obj.records[e][d].appendChild(u)}0<d&&(obj.records[e][d-1].style.overflow=t?"hidden":""),obj.ignoreEvents||"function"==typeof obj.options.onchange&&obj.options.onchange(el,obj.records[e]&&obj.records[e][d]?obj.records[e][d]:null,d,e,t,a.oldValue)}else var a={x:d,y:e,col:d,row:e};return a},obj.copyData=function(N,e){var t=obj.getData(!0,!0),o=obj.selectedContainer,r=parseInt(N.getAttribute("data-x")),n=parseInt(N.getAttribute("data-y")),l=parseInt(e.getAttribute("data-x")),s=parseInt(e.getAttribute("data-y")),i=[],a=!1;if(o[0]==r){if(n<o[1])var E=n-o[1];else E=1;var A=0}else A=r<o[0]?r-o[0]:1,E=0;for(var w=0,I=0,L=n;L<=s;L++)if(!obj.rows[L]||"none"!=obj.rows[L].style.display){(null==t[I]&&(I=0),w=0,o[0]!=r)&&(r<o[0]?A=r-o[0]:A=1);for(var R=r;R<=l;R++){if(obj.records[L][R]&&!obj.records[L][R].classList.contains("readonly")&&"none"!=obj.records[L][R].style.display&&0==a){if(!obj.selection.length&&""!=obj.options.data[L][R]){a=!0;continue}null==t[I]?w=0:null==t[I][w]&&(w=0);var S=t[I][w];if(S&&!t[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[R].type||"number"==obj.options.columns[R].type){if("="==(""+S).substr(0,1)){var M=S.match(/([A-Z]+[0-9]+)/g);if(M){for(var h=[],m=0,T;m<M.length;m++){T=jexcel.getIdFromColumnName(M[m],1),T[0]+=A,T[1]+=E,0>T[1]&&(T[1]=0);var D=jexcel.getColumnNameFromId([T[0],T[1]]);D!=M[m]&&(h[M[m]]=D)}h&&(S=obj.updateFormula(S,h))}}else S==+S&&(S=+S+E);}else if("calendar"==obj.options.columns[R].type){var C=new Date(S);C.setDate(C.getDate()+E),S=C.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(C.getMonth()+1))+"-"+jexcel.doubleDigitFormat(C.getDate())+" 00:00:00"}i.push(obj.updateCell(R,L,S)),obj.updateFormulaChain(R,L,i);var y=jexcel.getColumnNameFromId([R,L]);obj.setStyle(y,"background","#3D9970",null,1),i.push({style:!0,cell:y,oldValue:"background:",newValue:"background: green"}),obj.updateFormulaChain(R,L,i)}w++,o[0]!=r&&A++}I++,E++}obj.setHistory({action:"setValue",records:i,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,i)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,e,t){if(1==n){if(obj.selectedCell&&(e>=obj.selectedCell[1]&&e<=obj.selectedCell[3]||t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]))return void obj.resetSelection();}else if(obj.selectedCell&&(e>=obj.selectedCell[0]&&e<=obj.selectedCell[2]||t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(d){if(obj.highlighted.length){m=1;for(var e=0;e<obj.highlighted.length;e++){obj.highlighted[e].classList.remove("highlight"),obj.highlighted[e].classList.remove("highlight-left"),obj.highlighted[e].classList.remove("highlight-right"),obj.highlighted[e].classList.remove("highlight-top"),obj.highlighted[e].classList.remove("highlight-bottom"),obj.highlighted[e].classList.remove("highlight-selected");var c=parseInt(obj.highlighted[e].getAttribute("data-x")),o=parseInt(obj.highlighted[e].getAttribute("data-y"));if(obj.highlighted[e].getAttribute("data-merged"))var r=parseInt(obj.highlighted[e].getAttribute("colspan")),n=parseInt(obj.highlighted[e].getAttribute("rowspan")),l=0<r?c+(r-1):c,p=0<n?o+(n-1):o;else l=c,p=o;for(var g=c;g<=l;g++)obj.headers[g]&&obj.headers[g].classList.remove("selected");for(g=o;g<=p;g++)obj.rows[g]&&obj.rows[g].classList.remove("selected")}}else var m=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1!=obj.ignoreEvents&&1==d&&obj.options.onblur&&"function"==typeof obj.options.onblur&&1==m&&obj.options.onblur(el),m},obj.updateSelection=function(i,e,t){var o=i.getAttribute("data-x"),r=i.getAttribute("data-y");if(e)var n=e.getAttribute("data-x"),a=e.getAttribute("data-y");else n=o,a=r;obj.updateSelectionFromCoords(o,r,n,a,t)},obj.updateSelectionFromCoords=function(C,y,N,E,A){var n=obj.resetSelection();if(null==N&&(N=C),null==E&&(E=y),C>=obj.headers.length&&(C=obj.headers.length-1),y>=obj.rows.length&&(y=obj.rows.length-1),N>=obj.headers.length&&(N=obj.headers.length-1),E>=obj.rows.length&&(E=obj.rows.length-1),obj.selectedCell=[C,y,N,E],null!=C){if(obj.records[y][C]&&obj.records[y][C].classList.add("highlight-selected"),parseInt(C)<parseInt(N))var l=parseInt(C),w=parseInt(N);else l=parseInt(N),w=parseInt(C);if(parseInt(y)<parseInt(E))var I=parseInt(y),L=parseInt(E);else I=parseInt(E),L=parseInt(y);for(var R=l;R<=w;R++)for(var S=I;S<=L;S++)if(obj.records[S][R]&&obj.records[S][R].getAttribute("data-merged")){var M=parseInt(obj.records[S][R].getAttribute("data-x")),p=parseInt(obj.records[S][R].getAttribute("data-y")),d=parseInt(obj.records[S][R].getAttribute("colspan")),T=parseInt(obj.records[S][R].getAttribute("rowspan"));1<d&&(M<l&&(l=M),M+d>w&&(w=M+d-1)),T&&(p<I&&(I=p),p+T>L&&(L=p+T-1))}var f=null,x=null,D=null,O=null;for(S=I;S<=L;S++)"none"!=obj.rows[S].style.display&&(null==D&&(D=S),O=S);for(R=l;R<=w;R++){for(S=I;S<=L;S++)"none"!=obj.rows[S].style.display&&"none"!=obj.records[S][R].style.display&&(obj.records[S][R].classList.add("highlight"),obj.highlighted.push(obj.records[S][R]));"hidden"!=obj.options.columns[R].type&&(null==f&&(f=R),x=R)}for(f||(f=0),x||(x=0),R=f;R<=x;R++)"hidden"!=obj.options.columns[R].type&&(obj.records[D][R]&&obj.records[D][R].classList.add("highlight-top"),obj.records[O][R]&&obj.records[O][R].classList.add("highlight-bottom"),obj.headers[R].classList.add("selected"));for(S=D;S<=O;S++)"none"!=obj.rows[S].style.display&&(obj.records[S][f].classList.add("highlight-left"),obj.records[S][x].classList.add("highlight-right"),obj.rows[S].classList.add("selected"));obj.selectedContainer=[f,D,x,O]}1!=obj.ignoreEvents&&(obj.options.onfocus&&"function"==typeof obj.options.onfocus&&0==n&&obj.options.onfocus(el),"function"==typeof obj.options.onselection&&obj.options.onselection(el,f,D,x,O,A)),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var t=0;t<obj.selection.length;t++)obj.selection[t].classList.remove("selection"),obj.selection[t].classList.remove("selection-left"),obj.selection[t].classList.remove("selection-right"),obj.selection[t].classList.remove("selection-top"),obj.selection[t].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(d,e){obj.removeCopySelection();var t=obj.selectedContainer[0],o=obj.selectedContainer[1],r=obj.selectedContainer[2],n=obj.selectedContainer[3];if(null!=d&&null!=e){if(0<d-r)var l=parseInt(r)+1,p=parseInt(d);else l=parseInt(d),p=parseInt(t)-1;if(0<e-n)var g=parseInt(n)+1,m=parseInt(e);else g=parseInt(e),m=parseInt(o)-1;p-l<m-g?(l=parseInt(t),p=parseInt(r)):(g=parseInt(o),m=parseInt(n));for(var h=g;h<=m;h++)for(var C=l;C<=p;C++)obj.records[h][C]&&"none"!=obj.rows[h].style.display&&"none"!=obj.records[h][C].style.display&&(obj.records[h][C].classList.add("selection"),obj.records[g][C].classList.add("selection-top"),obj.records[m][C].classList.add("selection-bottom"),obj.records[h][l].classList.add("selection-left"),obj.records[h][p].classList.add("selection-right"),obj.selection.push(obj.records[h][C]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var d=obj.highlighted[obj.highlighted.length-1];const a=obj.content.getBoundingClientRect();var e=a.left,t=a.top;const u=d.getBoundingClientRect();var o=u.left,r=u.top,n=u.width,l=u.height,s=o-e+obj.content.scrollLeft+n-4,i=r-t+obj.content.scrollTop+l-4;obj.corner.style.top=i+"px",obj.corner.style.left=s+"px"}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(d){const e=obj.content.getBoundingClientRect();var t=e.left,o=e.top,r=e.width,n=e.height;const l=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect();var s=l.left,i=l.top,a=l.width,u=l.height;if(0==d||1==d)var c=s-t+obj.content.scrollLeft,g=i-o+obj.content.scrollTop-2;else c=s-t+obj.content.scrollLeft+a,g=i-o+obj.content.scrollTop+u;g>obj.content.scrollTop+30&&g<obj.content.scrollTop+n||(g<obj.content.scrollTop+30?obj.content.scrollTop=g-u:obj.content.scrollTop=g-(n-2)),c>obj.content.scrollLeft&&c<obj.content.scrollLeft+r||(c<obj.content.scrollLeft+30?(obj.content.scrollLeft=c,50>obj.content.scrollLeft&&(obj.content.scrollLeft=0)):obj.content.scrollLeft=c-(r-20))},obj.getWidth=function(n){if(n)"object"==typeof n&&(n=$(n).getAttribute("data-x")),r=obj.colgroup[n].getAttribute("width");else for(var r=[],s=0;s<obj.headers.length;s++)r.push(obj.options.columns[s].width);return r},obj.setWidth=function(n,r,t){0<r&&("object"==typeof n&&(n=n.getAttribute("data-x")),t||(t=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",r),obj.options.columns[n].width=r,obj.setHistory({action:"setWidth",column:n,oldValue:t,newValue:r}),1!=obj.ignoreEvents&&"function"==typeof obj.options.onresizecolumn&&obj.options.onresizecolumn(el,n,r,t),obj.updateCornerPosition())},obj.setHeight=function(n,r,s){0<r&&(("object"==typeof n&&(n=n.getAttribute("data-y")),!s)&&!(s=obj.rows[n].getAttribute("height"))&&(s=obj.rows[n].getBoundingClientRect().height),r=parseInt(r),obj.rows[n].style.height=r+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=r,obj.setHistory({action:"setHeight",row:n,oldValue:s,newValue:r}),1!=obj.ignoreEvents&&"function"==typeof obj.options.onresizerow&&obj.options.onresizerow(el,n,r,s),obj.updateCornerPosition())},obj.getHeight=function(n){if(n)"object"==typeof n&&(n=$(n).getAttribute("data-y")),s=obj.rows[n].style.height;else for(var s=[],l=0,i;l<obj.rows.length;l++)i=obj.rows[l].style.height,i&&(s[l]=i);return s},obj.getHeader=function(t){return obj.headers[t].innerText},obj.setHeader=function(n,e){if(obj.headers[n]){var r=obj.headers[n].innerText;e||(e=prompt(obj.options.text.columnName,r)),e&&(obj.headers[n].innerHTML=e,obj.headers[n].setAttribute("title",e)),obj.setHistory({action:"setHeader",column:n,oldValue:r,newValue:e}),obj.ignoreEvents||"function"==typeof obj.options.onchangeheader&&obj.options.onchangeheader(el,n,r,e)}},obj.getHeaders=function(n){for(var e=[],t=0;t<obj.headers.length;t++)e.push(obj.getHeader(t));return n?e:e.join(obj.options.csvDelimiter)},obj.getMeta=function(n,e){return n?e?obj.options.meta[n]&&obj.options.meta[n][e]?obj.options.meta[n][e]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(i,e,t){if(obj.options.meta||(obj.options.meta={}),e&&t)obj.options.meta[i]||(obj.options.meta[i]={}),obj.options.meta[i][e]=t;else for(var o=Object.keys(i),r=0;r<o.length;r++){obj.options.meta[o[r]]||(obj.options.meta[o[r]]={});for(var a=Object.keys(i[o[r]]),l=0;l<a.length;l++)obj.options.meta[o[r]][a[l]]=i[o[r]][a[l]]}1!=obj.ignoreEvents&&"function"==typeof obj.options.onchangemeta&&obj.options.onchangemeta(el,i,e,t)},obj.updateMeta=function(n){if(obj.options.meta){for(var e={},t=Object.keys(obj.options.meta),o=0;o<t.length;o++)n[t[o]]?e[n[t[o]]]=obj.options.meta[t[o]]:e[t[o]]=obj.options.meta[t[o]];obj.options.meta=e}},obj.getStyle=function(a,d){if(a)return a=jexcel.getIdFromColumnName(a,!0),d?obj.records[a[1]][a[0]].style[d]:obj.records[a[1]][a[0]].getAttribute("style");for(var t={},o=obj.options.data[0].length,r=obj.options.data.length,n=0;n<r;n++)for(var u=0,c;u<o;u++)c=d?obj.records[n][u].style[d]:obj.records[n][u].getAttribute("style"),c&&(t[jexcel.getColumnNameFromId([u,n])]=c);return t},obj.resetStyle=function(s,e){for(var t=Object.keys(s),o=0,l;o<t.length;o++)l=jexcel.getIdFromColumnName(t[o],!0),obj.records[l[1]]&&obj.records[l[1]][l[0]]&&obj.records[l[1]][l[0]].setAttribute("style","");obj.setStyle(s,null,null,null,e)},obj.setStyle=function(g,e,t,m,r){var h={},l={},n=function(r,e,t){var s=jexcel.getIdFromColumnName(r,!0);if(obj.records[s[1]]&&obj.records[s[1]][s[0]]){var n=obj.records[s[1]][s[0]].style[e];n!=t||m?obj.records[s[1]][s[0]].style[e]=t:(t="",obj.records[s[1]][s[0]].style[e]=""),l[r]||(l[r]=[]),h[r]||(h[r]=[]),l[r].push([e+":"+n]),h[r].push([e+":"+t])}};if(!(e&&t)){var o=Object.keys(g);for(a=0;a<o.length;a++){var s=g[o[a]];"string"==typeof s&&(s=s.split(";"));for(var i=0;i<s.length;i++)"string"==typeof s[i]&&(s[i]=s[i].split(":")),s[i][0].trim()&&n(o[a],s[i][0].trim(),s[i][1])}}else if("string"==typeof g)n(g,e,t);else for(var C=[],a=0;a<g.length;a++){var y=g[a].getAttribute("data-x"),c=g[a].getAttribute("data-y"),b=jexcel.getColumnNameFromId([y,c]);C[b]||(n(b,e,t),C[b]=!0)}for(o=Object.keys(l),a=0;a<o.length;a++)l[o[a]]=l[o[a]].join(";");for(o=Object.keys(h),a=0;a<o.length;a++)h[o[a]]=h[o[a]].join(";");r||obj.setHistory({action:"setStyle",oldValue:l,newValue:h}),1!=obj.ignoreEvents&&"function"==typeof obj.options.onchangestyle&&obj.options.onchangestyle(el,g,e,t)},obj.getComments=function(s,i){if(s)return"string"==typeof s&&(s=jexcel.getIdFromColumnName(s,!0)),i?[obj.records[s[1]][s[0]].getAttribute("title"),obj.records[s[1]][s[0]].getAttribute("author")]:obj.records[s[1]][s[0]].getAttribute("title")||"";for(var t={},o=0;o<obj.options.data.length;o++)for(var a=0,d;a<obj.options.columns.length;a++)d=obj.records[o][a].getAttribute("title"),d&&(t[s=jexcel.getColumnNameFromId([a,o])]=d);return t},obj.setComments=function(s,e,t){if("string"==typeof s)var l=jexcel.getIdFromColumnName(s,!0);else l=s;var i=[obj.records[l[1]][l[0]].getAttribute("title"),t=obj.records[l[1]][l[0]].getAttribute("data-author")];obj.records[l[1]][l[0]].setAttribute("title",e||""),obj.records[l[1]][l[0]].setAttribute("data-author",t||""),e?obj.records[l[1]][l[0]].classList.add("jexcel_comments"):obj.records[l[1]][l[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:s,newValue:[e,t],oldValue:i})},obj.getConfig=function(){var t=obj.options;return t.style=obj.getStyle(),t.mergeCells=obj.getMerge(),t.comments=obj.getComments(),t},obj.orderBy=function(s,e){if(0<=s){if(0<Object.keys(obj.options.mergeCells).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}e=null==e?obj.headers[s].classList.contains("arrow-down")?1:0:e?1:0,Array.prototype.orderBy=function(s,e){return this.slice(0).sort(function(t,o){var r=""==t[s]?"":+t[s]==t[s]?+t[s]:t[s].toLowerCase(),n=""==o[s]?"":+o[s]==o[s]?+o[s]:o[s].toLowerCase();return e?""==r&&""!=n?1:""!=r&&""==n?-1:r>n?-1:r<n?1:0:""==r&&""!=n?1:""!=r&&""==n?-1:r>n?1:r<n?-1:0})};var l=[];if("calendar"==obj.options.columns[s].type||"checkbox"==obj.options.columns[s].type||"radio"==obj.options.columns[s].type)for(var i=0;i<obj.options.data.length;i++)l[i]=[i,obj.options.data[i][s]];else for(i=0;i<obj.options.data.length;i++)l[i]=[i,obj.records[i][s].innerHTML];l=l.orderBy(1,e);var a=[];for(i=0;i<l.length;i++)a[i]=l[i][0];return obj.setHistory({action:"orderBy",rows:a,column:s,order:e}),obj.updateOrderArrow(s,e),obj.updateOrder(a),1!=obj.ignoreEvents&&"function"==typeof obj.options.onsort&&obj.options.onsort(el,s,e),!0}},obj.updateOrderArrow=function(n,e){for(var t=0;t<obj.headers.length;t++)obj.headers[t].classList.remove("arrow-up"),obj.headers[t].classList.remove("arrow-down");e?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var e=[],r=0;r<n.length;r++)e[r]=obj.options.data[n[r]];for(obj.options.data=e,e=[],r=0;r<n.length;r++)e[r]=obj.records[n[r]];for(obj.records=e,e=[],r=0;r<n.length;r++)e[r]=obj.rows[n[r]];if(obj.rows=e,obj.updateTableReferences(),obj.searchInput.value)obj.search(obj.searchInput.value);else if(obj.results=null,obj.pageNumber=0,0<obj.options.pagination)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(r=0;r<obj.rows.length;r++)obj.tbody.appendChild(obj.rows[r])},obj.moveRow=function(n,e,t){if(0<Object.keys(obj.options.mergeCells).length){if(n>e)var o=1;else o=0;if(obj.isRowMerged(n).length||obj.isRowMerged(e,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}t||(0<=Array.prototype.indexOf.call(obj.tbody.children,obj.rows[e])?n>e?obj.tbody.insertBefore(obj.rows[n],obj.rows[e]):obj.tbody.insertBefore(obj.rows[n],obj.rows[e].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(e,0,obj.rows.splice(n,1)[0]),obj.records.splice(e,0,obj.records.splice(n,1)[0]),obj.options.data.splice(e,0,obj.options.data.splice(n,1)[0]),0<obj.options.pagination&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:e}),obj.updateTableReferences(),1!=obj.ignoreEvents&&"function"==typeof obj.options.onmoverow&&obj.options.onmoverow(el,n,e)},obj.insertRow=function(g,e,m){if(1==obj.options.allowInsertRow){var h=[];if(0<g)var C=g;else C=1,g&&(h=g);m=!!m;var y=obj.options.data.length-1;if((null==e||e>=parseInt(y)||0>e)&&(e=y),"function"==typeof obj.options.onbeforeinsertrow&&!obj.options.onbeforeinsertrow(el,e,C,m))return console.log("onbeforeinsertrow returned false"),!1;if(0<Object.keys(obj.options.mergeCells).length&&obj.isRowMerged(e,m).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var l=m?e:e+1,s=obj.records.splice(l),i=obj.options.data.splice(l),a=obj.rows.splice(l),u=[],c=[],b=[],p=l;p<C+l;p++){obj.options.data[p]=[];for(var N=0;N<obj.options.columns.length;N++)obj.options.data[p][N]=h[N]?h[N]:"";var E=obj.createRow(p,obj.options.data[p]);a[0]?0<=Array.prototype.indexOf.call(obj.tbody.children,a[0])&&obj.tbody.insertBefore(E,a[0]):0<=Array.prototype.indexOf.call(obj.tbody.children,obj.rows[e])&&obj.tbody.appendChild(E),u.push(obj.records[p]),c.push(obj.options.data[p]),b.push(E)}Array.prototype.push.apply(obj.records,s),Array.prototype.push.apply(obj.options.data,i),Array.prototype.push.apply(obj.rows,a),0<obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:e,numOfRows:C,insertBefore:m,rowRecords:u,rowData:c,rowNode:b}),obj.updateTableReferences(),1!=obj.ignoreEvents&&"function"==typeof obj.options.oninsertrow&&obj.options.oninsertrow(el,e,C,u,m)}},obj.deleteRow=function(d,u){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||1<obj.options.data.length){if(null==d){var c=obj.getSelectedRows();c[0]?(d=parseInt(c[0].getAttribute("data-y")),u=c.length):(d=obj.options.data.length-1,u=1)}var o=obj.options.data.length-1;if((null==d||d>o||0>d)&&(d=o),u||(u=1),d+u>=obj.options.data.length&&(u=obj.options.data.length-d),"function"==typeof obj.options.onbeforedeleterow&&!obj.options.onbeforedeleterow(el,d,u))return console.log("onbeforedeleterow returned false"),!1;if(-1<parseInt(d)){var r=!1;if(0<Object.keys(obj.options.mergeCells).length)for(var p=d;p<d+u;p++)obj.isRowMerged(p,!1).length&&(r=!0);if(r){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(p=d;p<d+u;p++)0<=Array.prototype.indexOf.call(obj.tbody.children,obj.rows[p])&&(obj.rows[p].className="",obj.rows[p].parentNode.removeChild(obj.rows[p]));var g=obj.records.splice(d,u),s=obj.options.data.splice(d,u),i=obj.rows.splice(d,u);0<obj.options.pagination&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,d,d+u-1),obj.setHistory({action:"deleteRow",rowNumber:d,numOfRows:u,insertBefore:1,rowRecords:g,rowData:s,rowNode:i}),obj.updateTableReferences(),1!=obj.ignoreEvents&&"function"==typeof obj.options.ondeleterow&&obj.options.ondeleterow(el,d,u,g)}}else console.error("JEXCEL. It is not possible to delete the last row")},obj.moveColumn=function(n,s){if(0<Object.keys(obj.options.mergeCells).length){if(n>s)var l=1;else l=0;if(obj.isColMerged(n).length||obj.isColMerged(s,l).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(s=parseInt(s))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s]);for(var i=0;i<obj.rows.length;i++)obj.rows[i].insertBefore(obj.records[i][n],obj.records[i][s])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s].nextSibling),i=0;i<obj.rows.length;i++)obj.rows[i].insertBefore(obj.records[i][n],obj.records[i][s].nextSibling);for(obj.options.columns.splice(s,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(s,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(s,0,obj.colgroup.splice(n,1)[0]),i=0;i<obj.rows.length;i++)obj.options.data[i].splice(s,0,obj.options.data[i].splice(n,1)[0]),obj.records[i].splice(s,0,obj.records[i].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:s}),obj.updateTableReferences(),1!=obj.ignoreEvents&&"function"==typeof obj.options.onmovecolumn&&obj.options.onmovecolumn(el,n,s)},obj.insertColumn=function(N,e,E,A){if(1==obj.options.allowInsertColumn){var w=[];if(0<N)var I=N;else I=1,N&&(w=N);E=!!E;var L=obj.options.columns.length-1;if((null==e||e>=parseInt(L)||0>e)&&(e=L),"function"==typeof obj.options.onbeforeinsertcolumn&&!obj.options.onbeforeinsertcolumn(el,e,I,E))return console.log("onbeforeinsertcolumn returned false"),!1;if(0<Object.keys(obj.options.mergeCells).length&&obj.isColMerged(e,E).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}A||(A=[]);for(var s=0;s<I;s++)A[s]||(A[s]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var R=E?e:e+1;obj.options.columns=jexcel.injectArray(obj.options.columns,R,A);for(var a=obj.headers.splice(R),u=obj.colgroup.splice(R),c=[],b=[],p=[],d=[],S=R;S<I+R;S++)obj.createCellHeader(S),obj.headerContainer.insertBefore(obj.headers[S],obj.headerContainer.children[S+1]),obj.colgroupContainer.insertBefore(obj.colgroup[S],obj.colgroupContainer.children[S+1]),c.push(obj.headers[S]),b.push(obj.colgroup[S]);for(var M=0;M<obj.options.data.length;M++){var T=obj.options.data[M].splice(R),h=obj.records[M].splice(R);for(d[M]=[],p[M]=[],S=R;S<I+R;S++){var m=w[M]?w[M]:"";obj.options.data[M][S]=m;var v=obj.createCell(S,M,obj.options.data[M][S]);obj.records[M][S]=v,obj.rows[M]&&obj.rows[M].insertBefore(v,obj.rows[M].children[S+1]),d[M].push(m),p[M].push(v)}Array.prototype.push.apply(obj.options.data[M],T),Array.prototype.push.apply(obj.records[M],h)}if(Array.prototype.push.apply(obj.headers,a),Array.prototype.push.apply(obj.colgroup,u),obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var x=0,D;x<obj.options.nestedHeaders.length;x++)D=parseInt(obj.options.nestedHeaders[x][obj.options.nestedHeaders[x].length-1].colspan)+I,obj.options.nestedHeaders[x][obj.options.nestedHeaders[x].length-1].colspan=D,obj.thead.children[x].children[obj.thead.children[x].children.length-1].setAttribute("colspan",D);else D=parseInt(obj.options.nestedHeaders[0].colspan)+I,obj.options.nestedHeaders[0].colspan=D,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",D);obj.setHistory({action:"insertColumn",columnNumber:e,numOfColumns:I,insertBefore:E,columns:A,headers:c,colgroup:b,records:p,data:d}),obj.updateTableReferences(),1!=obj.ignoreEvents&&"function"==typeof obj.options.oninsertcolumn&&obj.options.oninsertcolumn(el,e,I,p,E)}},obj.deleteColumn=function(g,m){if(1==obj.options.allowDeleteColumn)if(1<obj.headers.length){if(null==g){var h=obj.getSelectedColumns(!0);h.length?(g=parseInt(h[0]),m=parseInt(h.length)):(g=obj.headers.length-1,m=1)}var o=obj.options.data[0].length-1;if((null==g||g>o||0>g)&&(g=o),m||(m=1),m>obj.options.data[0].length-g&&(m=obj.options.data[0].length-g),"function"==typeof obj.options.onbeforedeletecolumn&&!obj.options.onbeforedeletecolumn(el,g,m))return console.log("onbeforedeletecolumn returned false"),!1;if(-1<parseInt(g)){var r=!1;if(0<Object.keys(obj.options.mergeCells).length)for(var C=g;C<g+m;C++)obj.isColMerged(C,!1).length&&(r=!0);if(r){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var f=obj.options.columns.splice(g,m);for(C=g;C<g+m;C++)obj.colgroup[C].className="",obj.headers[C].className="",obj.colgroup[C].parentNode.removeChild(obj.colgroup[C]),obj.headers[C].parentNode.removeChild(obj.headers[C]);for(var s=obj.headers.splice(g,m),i=obj.colgroup.splice(g,m),a=[],u=[],c=0;c<obj.options.data.length;c++)for(C=g;C<g+m;C++)obj.records[c][C].className="",obj.records[c][C].parentNode.removeChild(obj.records[c][C]);for(c=0;c<obj.options.data.length;c++)u[c]=obj.options.data[c].splice(g,m),a[c]=obj.records[c].splice(g,m);if(obj.conditionalSelectionUpdate(0,g,g+m-1),obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var y=0,N;y<obj.options.nestedHeaders.length;y++)N=parseInt(obj.options.nestedHeaders[y][obj.options.nestedHeaders[y].length-1].colspan)-m,obj.options.nestedHeaders[y][obj.options.nestedHeaders[y].length-1].colspan=N,obj.thead.children[y].children[obj.thead.children[y].children.length-1].setAttribute("colspan",N);else N=parseInt(obj.options.nestedHeaders[0].colspan)-m,obj.options.nestedHeaders[0].colspan=N,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",N);obj.setHistory({action:"deleteColumn",columnNumber:g,numOfColumns:m,insertBefore:1,columns:f,headers:s,colgroup:i,records:a,data:u}),obj.updateTableReferences(),1!=obj.ignoreEvents&&"function"==typeof obj.options.ondeletecolumn&&obj.options.ondeletecolumn(el,g,m,a)}}else console.error("JEXCEL. It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var e=[],t=0;t<obj.rows.length;t++)obj.rows[t].classList.contains("selected")&&(n?e.push(t):e.push(obj.rows[t]));return e},obj.getSelectedColumns=function(){for(var n=[],e=0;e<obj.headers.length;e++)obj.headers[e].classList.contains("selected")&&n.push(e);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var d=0;d<obj.headers.length;d++)(n=obj.headers[d].getAttribute("data-x"))!=d&&(obj.headers[d].setAttribute("data-x",d),obj.headers[d].getAttribute("title")||(obj.headers[d].innerHTML=jexcel.getColumnName(d)));for(var g=0;g<obj.rows.length;g++)obj.rows[g]&&(h=obj.rows[g].getAttribute("data-y"))!=g&&(obj.rows[g].setAttribute("data-y",g),obj.rows[g].children[0].setAttribute("data-y",g),obj.rows[g].children[0].innerHTML=g+1);var m=[],o=[],r=function(o,e,t,r){if(o!=t&&obj.records[r][t].setAttribute("data-x",t),e!=r&&obj.records[r][t].setAttribute("data-y",r),o!=t||e!=r){var n=jexcel.getColumnNameFromId([o,e]),l=jexcel.getColumnNameFromId([t,r]);m[n]=l}};for(g=0;g<obj.records.length;g++)for(d=0;d<obj.records[0].length;d++)if(obj.records[g][d]){var n=obj.records[g][d].getAttribute("data-x"),h=obj.records[g][d].getAttribute("data-y");if(obj.records[g][d].getAttribute("data-merged")){var C=jexcel.getColumnNameFromId([n,h]),f=jexcel.getColumnNameFromId([d,g]);if(null==o[C])if(C==f)o[C]=!1;else{var y=parseInt(d-n),u=parseInt(g-h);o[C]=[f,y,u]}}else r(n,h,d,g)}var c=Object.keys(o);if(c.length)for(d=0;d<c.length;d++)if(o[c[d]]){var b=jexcel.getIdFromColumnName(c[d],!0);for(r(n=b[0],h=b[1],n+o[c[d]][1],h+o[c[d]][2]),C=c[d],f=o[c[d]][0],g=0;g<obj.options.mergeCells[C][2].length;g++)n=parseInt(obj.options.mergeCells[C][2][g].getAttribute("data-x")),h=parseInt(obj.options.mergeCells[C][2][g].getAttribute("data-y")),obj.options.mergeCells[C][2][g].setAttribute("data-x",n+o[c[d]][1]),obj.options.mergeCells[C][2][g].setAttribute("data-y",h+o[c[d]][2]);obj.options.mergeCells[f]=obj.options.mergeCells[C],delete obj.options.mergeCells[C]}obj.updateFormulas(m),obj.updateMeta(m),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(0<obj.options.minSpareRows){for(var s=0,l=obj.rows.length-1;0<=l;l--){for(var i=!1,a=0;a<obj.headers.length;a++)obj.options.data[l][a]&&(i=!0);if(i)break;s++}0<obj.options.minSpareRows-s&&obj.insertRow(obj.options.minSpareRows-s)}if(0<obj.options.minSpareCols){var d=0;for(a=obj.headers.length-1;0<=a;a--){for(i=!1,l=0;l<obj.rows.length;l++)obj.options.data[l][a]&&(i=!0);if(i)break;d++}0<obj.options.minSpareCols-d&&obj.insertColumn(obj.options.minSpareCols-d)}if("function"==typeof obj.options.updateTable){for(obj.options.detachForUpdates&&el.removeChild(obj.content),l=0;l<obj.rows.length;l++)for(a=0;a<obj.headers.length;a++)obj.options.updateTable(el,obj.records[l][a],a,l,obj.options.data[l][a],obj.records[l][a].innerText,jexcel.getColumnNameFromId([a,l]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}setTimeout(function(){obj.updateCornerPosition()},0)},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="";for(var e=0;e<obj.options.data.length;e++)obj.records[e][n].style.display=""},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none";for(var e=0;e<obj.options.data.length;e++)obj.records[e][n].style.display="none"},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];return obj.updateFormulaChain=function(i,e,t){var o=jexcel.getColumnNameFromId([i,e]);if(obj.formula[o]&&0<obj.formula[o].length)if(chainLoopProtection[o])obj.records[e][i].innerHTML="#ERROR",obj.formula[o]="";else{chainLoopProtection[o]=!0;for(var r=0;r<obj.formula[o].length;r++){var a=jexcel.getIdFromColumnName(obj.formula[o][r],!0),l=""+obj.options.data[a[1]][a[0]];"="==l.substr(0,1)?t.push(obj.updateCell(a[0],a[1],l,!0)):Object.keys(obj.formula)[r]=null,obj.updateFormulaChain(a[0],a[1],t)}}chainLoopProtection=[]},obj.updateFormulas=function(d){for(var e=0;e<obj.options.data.length;e++)for(var u=0;u<obj.options.data[0].length;u++)if("="==(p=""+obj.options.data[e][u]).substr(0,1)){var c=obj.updateFormula(p,d);c!=p&&(obj.options.data[e][u]=c)}var r=[],n=Object.keys(obj.formula);for(e=0;e<n.length;e++){var l=n[e],p=obj.formula[l];for(d[l]&&(l=d[l]),r[l]=[],u=0;u<p.length;u++){var g=p[u];d[g]&&(g=d[g]),r[l].push(g)}}obj.formula=r},obj.updateFormula=function(d,e){for(var t=/[A-Z]/,o=/[0-9]/,r="",u=null,c=null,p="",g=0;g<d.length;g++)t.exec(d[g])?(u=1,c=0,p+=d[g]):o.exec(d[g])?(c=u?1:0,p+=d[g]):(u&&c&&(p=e[p]?e[p]:p),r+=p,r+=d[g],u=0,c=0,p="");return p&&(u&&c&&(p=e[p]?e[p]:p),r+=p),r},obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(d){for(var e=0;e<d.length;e++){var p=[],o=d[e].split(":"),r=jexcel.getIdFromColumnName(o[0],!0),n=jexcel.getIdFromColumnName(o[1],!0);if(r[0]<=n[0])var l=r[0],g=n[0];else l=n[0],g=r[0];if(r[1]<=n[1])var m=r[1],h=n[1];else m=n[1],h=r[1];for(var C=m;C<=h;C++)for(var f=l;f<=g;f++)p.push(jexcel.getColumnNameFromId([f,C]));expression=expression.replace(d[e],p.join(","))}},tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var evalstring="",tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&-1<tokens.indexOf(parentId))return console.error("Self Reference detected"),"#ERROR";if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),0>obj.formula[tokens[i]].indexOf(parentId)&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+") == \"undefined\"")){var position=jexcel.getIdFromColumnName(tokens[i],1);if(void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]])var value=obj.options.data[position[1]][position[0]];else var value="";if("="==(""+value).substr(0,1)&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())evalstring+="var "+tokens[i]+" = null;";else if(value==+value&&1==obj.options.autoCasting)evalstring+="var "+tokens[i]+" = "+ +value+";";else{var number=obj.parseNumber(value,position[0]);evalstring+=1==obj.options.autoCasting&&number?"var "+tokens[i]+" = "+number+";":"var "+tokens[i]+" = '"+value+"';"}}try{evalstring+="function COLUMN() { return parseInt(x) + 1; }; function ROW() { return parseInt(y) + 1; }; function CELL() { return parentId; };";var res=eval(evalstring+expression.substr(1))}catch(t){var res="#ERROR"}return res};return execute(expression,x,y)},obj.parseNumber=function(n,s){var t=s&&obj.options.columns[s].decimal?obj.options.columns[s].decimal:".",o=""+n;if((o=o.split(t))[0]=o[0].match(/[+-]?[0-9]/g),o[0]&&(o[0]=o[0].join("")),o[1]&&(o[1]=o[1].match(/[0-9]*/g).join("")),!(o[0]&&0<=+o[0]))n=null;else if(o[1])n=+(o[0]+"."+o[1]);else var n=+(o[0]+".00");return n},obj.row=function(){},obj.col=function(){},obj.up=function(n,e){if(n?0<obj.selectedCell[3]&&obj.up.visible(1,e?0:1):(0<obj.selectedCell[1]&&obj.up.visible(0,e?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading){if(0==obj.selectedCell[1]||0==obj.selectedCell[3])obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var t=parseInt(obj.tbody.firstChild.getAttribute("data-y"));30>obj.selectedCell[1]-t&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}}else if(0<obj.options.pagination){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}obj.updateScroll(1)},obj.up.visible=function(s,e){if(0==s)var t=parseInt(obj.selectedCell[0]),l=parseInt(obj.selectedCell[1]);else t=parseInt(obj.selectedCell[2]),l=parseInt(obj.selectedCell[3]);if(0==e){for(var i=0;i<l;i++)if("none"!=obj.records[i][t].style.display&&"none"!=obj.rows[i].style.display){l=i;break}}else l=obj.up.get(t,l);0==s?(obj.selectedCell[0]=t,obj.selectedCell[1]=l):(obj.selectedCell[2]=t,obj.selectedCell[3]=l)},obj.up.get=function(n,r){n=parseInt(n);for(var s=(r=parseInt(r))-1;0<=s;s--)if("none"!=obj.records[s][n].style.display&&"none"!=obj.rows[s].style.display){if(obj.records[s][n].getAttribute("data-merged")&&obj.records[s][n]==obj.records[r][n])continue;r=s;break}return r},obj.down=function(n,e){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,e?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,e?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):30>parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(0<obj.options.pagination){var t=obj.whichPage(obj.selectedCell[3]);t!=obj.pageNumber&&obj.page(t)}obj.updateScroll(3)},obj.down.visible=function(s,e){if(0==s)var t=parseInt(obj.selectedCell[0]),l=parseInt(obj.selectedCell[1]);else t=parseInt(obj.selectedCell[2]),l=parseInt(obj.selectedCell[3]);if(0==e){for(var i=obj.rows.length-1;i>l;i--)if("none"!=obj.records[i][t].style.display&&"none"!=obj.rows[i].style.display){l=i;break}}else l=obj.down.get(t,l);0==s?(obj.selectedCell[0]=t,obj.selectedCell[1]=l):(obj.selectedCell[2]=t,obj.selectedCell[3]=l)},obj.down.get=function(n,r){n=parseInt(n);for(var s=(r=parseInt(r))+1;s<obj.rows.length;s++)if("none"!=obj.records[s][n].style.display&&"none"!=obj.rows[s].style.display){if(obj.records[s][n].getAttribute("data-merged")&&obj.records[s][n]==obj.records[r][n])continue;r=s;break}return r},obj.right=function(n,e){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,e?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,e?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(s,e){if(0==s)var t=parseInt(obj.selectedCell[0]),l=parseInt(obj.selectedCell[1]);else t=parseInt(obj.selectedCell[2]),l=parseInt(obj.selectedCell[3]);if(0==e){for(var i=obj.headers.length-1;i>t;i--)if("none"!=obj.records[l][i].style.display){t=i;break}}else t=obj.right.get(t,l);0==s?(obj.selectedCell[0]=t,obj.selectedCell[1]=l):(obj.selectedCell[2]=t,obj.selectedCell[3]=l)},obj.right.get=function(n,r){n=parseInt(n),r=parseInt(r);for(var s=n+1;s<obj.headers.length;s++)if("none"!=obj.records[r][s].style.display){if(obj.records[r][s].getAttribute("data-merged")&&obj.records[r][s]==obj.records[r][n])continue;n=s;break}return n},obj.left=function(n,e){n?0<obj.selectedCell[2]&&obj.left.visible(1,e?0:1):(0<obj.selectedCell[0]&&obj.left.visible(0,e?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(s,e){if(0==s)var t=parseInt(obj.selectedCell[0]),l=parseInt(obj.selectedCell[1]);else t=parseInt(obj.selectedCell[2]),l=parseInt(obj.selectedCell[3]);if(0==e){for(var i=0;i<t;i++)if("none"!=obj.records[l][i].style.display){t=i;break}}else t=obj.left.get(t,l);0==s?(obj.selectedCell[0]=t,obj.selectedCell[1]=l):(obj.selectedCell[2]=t,obj.selectedCell[3]=l)},obj.left.get=function(n,r){n=parseInt(n),r=parseInt(r);for(var s=n-1;0<=s;s--)if("none"!=obj.records[r][s].style.display){if(obj.records[r][s].getAttribute("data-merged")&&obj.records[r][s]==obj.records[r][n])continue;n=s;break}return n},obj.first=function(n,e){if(n?e?obj.selectedCell[3]=0:obj.left.visible(1,0):(e?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1==obj.options.lazyLoading&&(0==obj.selectedCell[1]||0==obj.selectedCell[3]))obj.loadPage(0);else if(0<obj.options.pagination){var t=obj.whichPage(obj.selectedCell[3]);t!=obj.pageNumber&&obj.page(t)}obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,e){if(n?e?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(e?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1==obj.options.lazyLoading&&(obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1))obj.loadPage(-1);else if(0<obj.options.pagination){var t=obj.whichPage(obj.selectedCell[3]);t!=obj.pageNumber&&obj.page(t)}obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(s){if(1==obj.options.search&&obj.results)var l=obj.results;else l=obj.rows;null!=s&&-1!=s||(s=_Mathceil(l.length/100));var i=100*s,a=100*s+100;a>l.length&&(a=l.length),0>(i=a-100)&&(i=0);for(var d=i;d<a;d++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[l[d]]):obj.tbody.appendChild(obj.rows[d]),100<obj.tbody.children.length&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(1==obj.options.search&&obj.results)var n=obj.results;else n=obj.rows;var s=0;if(100<n.length){var l=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(l=n.indexOf(l)),0<l)for(var i=0;30>i;i++)-1<(l-=1)&&(1==obj.options.search&&obj.results?obj.tbody.insertBefore(obj.rows[n[l]],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[l],obj.tbody.firstChild),100<obj.tbody.children.length&&(obj.tbody.removeChild(obj.tbody.lastChild),s=1))}return s},obj.loadDown=function(){if(1==obj.options.search&&obj.results)var n=obj.results;else n=obj.rows;var s=0;if(100<n.length){var l=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(l=n.indexOf(l)),l<obj.rows.length-1)for(var i=0;30>=i;i++)l<n.length&&(1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[n[l]]):obj.tbody.appendChild(obj.rows[l]),100<obj.tbody.children.length&&(obj.tbody.removeChild(obj.tbody.firstChild),s=1)),l+=1}return s},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,e=parseInt(obj.selectedCell[3]/100),t=parseInt(obj.rows.length/100);if(n!=e&&e<=t&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(e),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(a){if(a&&(a=a.toLowerCase()),obj.resetSelection(),obj.pageNumber=0,obj.results=[],a){var d=function(t){-1==obj.results.indexOf(t)&&obj.results.push(t)};obj.options.data.filter(function(e,t){if(function(n,e,t){for(var o=0;o<n.length;o++)if(0<=(""+n[o]).toLowerCase().search(e)||0<=(""+obj.records[t][o].innerHTML).toLowerCase().search(e))return!0;return!1}(e,a,t)){var r=obj.isRowMerged(t);if(r.length)for(var n=0;n<r.length;n++)for(var o=jexcel.getIdFromColumnName(r[n],!0),s=0;s<obj.options.mergeCells[r[n]][1];s++)d(o[1]+s);else d(t);return!0}return!1})}else obj.results=null;var t=0,s=0;for(t=1==obj.options.lazyLoading?100:0<obj.options.pagination?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var l=0;l<obj.rows.length;l++)!obj.results||-1<obj.results.indexOf(l)?(s<t&&(obj.tbody.appendChild(obj.rows[l]),s++),obj.rows[l].style.display=""):obj.rows[l].style.display="none";return 0<obj.options.pagination&&obj.updatePagination(),t},obj.whichPage=function(t){return 1==obj.options.search&&obj.results&&(t=obj.results.indexOf(t)),_Mathceil((parseInt(t)+1)/parseInt(obj.options.pagination))-1},obj.page=function(i){var a=obj.pageNumber;if(1==obj.options.search&&obj.results)var t=obj.results;else t=obj.rows;var d=parseInt(obj.options.pagination);null!=i&&-1!=i||(i=_Mathceil(t.length/d)),obj.pageNumber=i;var r=i*d,u=i*d+d;for(u>t.length&&(u=t.length),0>r&&(r=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var c=r;c<u;c++)1==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[t[c]]):obj.tbody.appendChild(obj.rows[c]);0<obj.options.pagination&&obj.updatePagination(),obj.updateCornerPosition(),"function"==typeof obj.options.onchangepage&&obj.options.onchangepage(el,i,a)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(1==obj.options.search&&obj.results)var s=obj.results.length;else s=obj.rows.length;if(s){var i=_Mathceil(s/obj.options.pagination);if(6>obj.pageNumber)var t=1,a=10>i?i:10;else 5>i-obj.pageNumber?(a=i,1>(t=i-9)&&(t=1)):(t=obj.pageNumber-4,a=obj.pageNumber+5);1<t&&((u=document.createElement("div")).className="jexcel_page",u.innerHTML="<",u.title=1,obj.pagination.children[1].appendChild(u));for(var d=t;d<=a;d++){var u;(u=document.createElement("div")).className="jexcel_page",u.innerHTML=d,obj.pagination.children[1].appendChild(u),obj.pageNumber==d-1&&u.classList.add("jexcel_page_selected")}a<i&&((u=document.createElement("div")).className="jexcel_page",u.innerHTML=">",u.title=i,obj.pagination.children[1].appendChild(u)),obj.pagination.children[0].innerHTML=function(n){var r=Array.prototype.slice.call(arguments,1);return n.replace(/{(\d+)}/g,function(t,e){return void 0===r[e]?t:r[e]})}(obj.options.text.showingPage,obj.pageNumber+1,i)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(s){if(0==obj.options.allowExport)console.error("Export not allowed");else{var e="";1!=s&&1!=obj.options.includeHeadersOnDownload||(e+=obj.getHeaders(),e+="\r\n"),e+=obj.copy(!1,obj.options.csvDelimiter,!0);var l=new Blob(["\uFEFF"+e],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(l,options.csvFileName+".csv");else{var o=document.createElement("a"),r=URL.createObjectURL(l);o.href=r,o.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(o),o.click(),o.parentNode.removeChild(o)}}},obj.setHistory=function(n){if(1!=obj.ignoreHistory){var e=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,e+1),obj.history[e]=n}},obj.copy=function(g,e,m){e||(e="\t");var o=[],h=[],C=[],l=[],s=obj.options.data[0].length,i=obj.options.data.length,a="";obj.style=[];for(var y=0;y<i;y++){o=[],h=[];for(var N=0;N<s;N++)if(!g||obj.records[y][N].classList.contains("highlight")){var E=obj.options.data[y][N];if(E.match&&(E.match(/,/g)||E.match(/\n/)||E.match(/\"/))&&(E="\""+(E=E.replace(/"/g,"\"\""))+"\""),o.push(E),"checkbox"==obj.options.columns[N].type||"radio"==obj.options.columns[N].type)var A=E;else(A=obj.records[y][N].innerHTML).match&&(A.match(/,/g)||A.match(/\n/)||A.match(/\"/))&&(A="\""+(A=A.replace(/"/g,"\"\""))+"\"");h.push(A),a=obj.records[y][N].getAttribute("style"),obj.style.push(a||"")}o.length&&C.push(o.join(e)),h.length&&l.push(h.join(e))}var w=C.join("\r\n"),I=l.join("\r\n");return m||(obj.textarea.value=1==obj.options.copyCompatibility?I:w,obj.textarea.select(),document.execCommand("copy")),obj.data=1==obj.options.copyCompatibility?I:w,obj.hashString=obj.hash(obj.data),obj.data},obj.paste=function(g,e,t){"function"==typeof obj.options.onbeforepaste&&(t=obj.options.onbeforepaste(el,t));var m=obj.hash(t),r=m==obj.hashString?obj.style:null;if(1==obj.options.copyCompatibility&&m==obj.hashString&&(t=obj.data),t=obj.parseCSV(t,"\t"),null!=g&&null!=e&&t){for(var n=0,h=0,C=[],i={},a={},u=0,y=parseInt(g),N=parseInt(e),E=null;E=t[h];){for(n=0,y=parseInt(g);null!=E[n];){var A=obj.updateCell(y,N,E[n]);if(C.push(A),obj.updateFormulaChain(y,N,C),r&&r[u]){var w=jexcel.getColumnNameFromId([y,N]);i[w]=r[u],a[w]=obj.getStyle(w),obj.records[N][y].setAttribute("style",r[u]),u++}null!=E[++n]&&(y>=obj.headers.length-1&&obj.insertColumn(),y=obj.right.get(y,N))}t[++h]&&(N>=obj.rows.length-1&&obj.insertRow(),N=obj.down.get(g,N))}obj.updateSelectionFromCoords(g,e,y,N),obj.setHistory({action:"setValue",records:C,selection:obj.selectedCell,newStyle:i,oldStyle:a}),obj.updateTable(),"function"==typeof obj.options.onpaste&&obj.options.onpaste(el,C),obj.onafterchanges(el,C)}},obj.historyProcessRow=function(s,e){var t=e.insertBefore?e.rowNumber:e.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==s){for(var o=e.numOfRows,r=t;r<o+t;r++)obj.rows[r].parentNode.removeChild(obj.rows[r]);obj.records.splice(t,o),obj.options.data.splice(t,o),obj.rows.splice(t,o),obj.conditionalSelectionUpdate(1,t,o+t-1)}else{obj.records=jexcel.injectArray(obj.records,t,e.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,t,e.rowData),obj.rows=jexcel.injectArray(obj.rows,t,e.rowNode);var i=0;for(r=t;r<e.numOfRows+t;r++)obj.tbody.insertBefore(e.rowNode[i],obj.tbody.children[r]),i++}0<obj.options.pagination&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(a,e){var t=e.insertBefore?e.columnNumber:e.columnNumber+1;if(1==a){var o=e.numOfColumns;obj.options.columns.splice(t,o);for(var r=t;r<o+t;r++)obj.headers[r].parentNode.removeChild(obj.headers[r]),obj.colgroup[r].parentNode.removeChild(obj.colgroup[r]);obj.headers.splice(t,o),obj.colgroup.splice(t,o);for(var d=0;d<e.data.length;d++){for(r=t;r<o+t;r++)obj.records[d][r].parentNode.removeChild(obj.records[d][r]);obj.records[d].splice(t,o),obj.options.data[d].splice(t,o)}obj.conditionalSelectionUpdate(0,t,o+t-1)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,t,e.columns),obj.headers=jexcel.injectArray(obj.headers,t,e.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,t,e.colgroup);var u=0;for(r=t;r<e.numOfColumns+t;r++)obj.headerContainer.insertBefore(e.headers[u],obj.headerContainer.children[r+1]),obj.colgroupContainer.insertBefore(e.colgroup[u],obj.colgroupContainer.children[r+1]),u++;for(d=0;d<e.data.length;d++)for(obj.options.data[d]=jexcel.injectArray(obj.options.data[d],t,e.data[d]),obj.records[d]=jexcel.injectArray(obj.records[d],t,e.records[d]),(u=0,r=t);r<e.numOfColumns+t;r++)obj.rows[d].insertBefore(e.records[d][u],obj.rows[d].children[r+1]),u++}if(obj.options.nestedHeaders&&0<obj.options.nestedHeaders.length)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(d=0;d<obj.options.nestedHeaders.length;d++){if(1==a)var c=parseInt(obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan)-e.numOfColumns;else c=parseInt(obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan)+e.numOfColumns;obj.options.nestedHeaders[d][obj.options.nestedHeaders[d].length-1].colspan=c,obj.thead.children[d].children[obj.thead.children[d].children.length-1].setAttribute("colspan",c)}else c=1==a?parseInt(obj.options.nestedHeaders[0].colspan)-e.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+e.numOfColumns,obj.options.nestedHeaders[0].colspan=c,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",c);obj.updateTableReferences()},obj.undo=function(){var i=!!obj.ignoreEvents,e=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var t=[];if(0<=obj.historyIndex){var o=obj.history[obj.historyIndex--];if("insertRow"==o.action)obj.historyProcessRow(1,o);else if("deleteRow"==o.action)obj.historyProcessRow(0,o);else if("insertColumn"==o.action)obj.historyProcessColumn(1,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(0,o);else if("moveRow"==o.action)obj.moveRow(o.newValue,o.oldValue);else if("moveColumn"==o.action)obj.moveColumn(o.newValue,o.oldValue);else if("setMerge"==o.action)obj.removeMerge(o.column,o.data);else if("setStyle"==o.action)obj.setStyle(o.oldValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.oldValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.oldValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.oldValue);else if("setComments"==o.action)obj.setComments(o.column,o.oldValue[0],o.oldValue[1]);else if("orderBy"==o.action){for(var r=[],n=0;n<o.rows.length;n++)r[o.rows[n]]=n;obj.updateOrderArrow(o.column,o.order?0:1),obj.updateOrder(r)}else if("setValue"==o.action){for(var a=0;a<o.records.length;a++)"x"in o.records[a]?(obj.updateCell(o.records[a].col,o.records[a].row,o.records[a].oldValue),obj.updateFormulaChain(o.records[a].col,o.records[a].row,t),o.oldStyle&&obj.resetStyle(o.oldStyle,!0)):obj.setStyle(o.records[a].cell,"background","white",null,1);o.selection||(o.selection=[o.records[0].col,o.records[0].row]),obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3]),obj.updateTable()}}obj.ignoreEvents=i,obj.ignoreHistory=e,"function"==typeof obj.options.onundo&&obj.options.onundo(el,o)},obj.redo=function(){var s=!!obj.ignoreEvents,e=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var t=[];if(obj.historyIndex<obj.history.length-1){var o=obj.history[++obj.historyIndex];if("insertRow"==o.action)obj.historyProcessRow(0,o);else if("deleteRow"==o.action)obj.historyProcessRow(1,o);else if("insertColumn"==o.action)obj.historyProcessColumn(0,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(1,o);else if("moveRow"==o.action)obj.moveRow(o.oldValue,o.newValue);else if("moveColumn"==o.action)obj.moveColumn(o.oldValue,o.newValue);else if("setMerge"==o.action)obj.setMerge(o.column,o.colspan,o.rowspan,1);else if("setStyle"==o.action)obj.setStyle(o.newValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.newValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.newValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.newValue);else if("setComments"==o.action)obj.setComments(o.column,o.newValue[0],o.newValue[1]);else if("orderBy"==o.action)obj.updateOrderArrow(o.column,o.order),obj.updateOrder(o.rows);else if("setValue"==o.action){for(var r=0;r<o.records.length;r++)"x"in o.records[r]?(obj.updateCell(o.records[r].col,o.records[r].row,o.records[r].newValue),obj.updateFormulaChain(o.records[r].col,o.records[r].row,t),o.newStyle&&obj.resetStyle(o.newStyle,!0)):obj.setStyle(o.records[r].cell,"background","#3D9970",null,1);o.selection||(o.selection=[o.records[0].col,o.records[0].row]),obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3]),obj.updateTable()}}obj.ignoreEvents=s,obj.ignoreHistory=e,"function"==typeof obj.options.onredo&&obj.options.onredo(el,o)},obj.getDropDownValue=function(i,e){var t=[];if(obj.options.columns[i]&&obj.options.columns[i].source){for(var o=[],r=obj.options.columns[i].source,n=0;n<r.length;n++)"object"==typeof r[n]?o[r[n].id]=r[n].name:o[r[n]]=r[n];var a=(""+e).split(";");for(n=0;n<a.length;n++)o[a[n]]&&t.push(o[a[n]])}else console.error("Invalid column");return 0<t.length?t.join("; "):""},obj.parseCSV=function(d,u){9==(d=d.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(d.length-1)&&(d+="\0"),u=u||",";for(var c=[],o=!1,p=0,g=0,m=0;m<d.length;m++){var h=d[m],i=d[m+1];c[p]=c[p]||[],c[p][g]=c[p][g]||"","\""==h&&o&&"\""==i?(c[p][g]+=h,++m):"\""==h?o=!o:h!=u||o?"\r"!=h||"\n"!=i||o?("\n"!=h||o)&&("\r"!=h||o)?c[p][g]+=h:(++p,g=0):(++p,g=0,++m):++g}return c},obj.hash=function(n){var e=0,r;if(0===n.length)return e;for(r=0;r<n.length;r++)e=(e<<5)-e+n.charCodeAt(r),e|=0;return e},obj.onafterchanges=function(n,e){obj.ignoreEvents||"function"==typeof obj.options.onafterchanges&&obj.options.onafterchanges(n,e)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(jexcel.build(),jexcel.build=null),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:"GET",dataType:"text",success:function(n){var e=obj.parseCSV(n,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&0<e.length)for(var t=e.shift(),o=0;o<t.length;o++)obj.options.columns[o]||(obj.options.columns[o]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),void 0===obj.options.columns[o].title&&(obj.options.columns[o].title=t[o]);obj.options.data=e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:"GET",dataType:"json",success:function(t){obj.options.data=t.data?t.data:t,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},obj.options.contextMenu=options&&null!=options.contextMenu?options.contextMenu:function(r,s,t){var e=[];if(null==t)1==obj.options.allowInsertColumn&&e.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(s),1)}}),1==obj.options.allowInsertColumn&&e.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(s),0)}}),1==obj.options.allowDeleteColumn&&e.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(s))}}),1==obj.options.allowRenameColumn&&e.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(s)}}),1==obj.options.columnSorting&&(e.push({type:"line"}),e.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(s,0)}}),e.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(s,1)}}));else if(1==obj.options.allowInsertRow&&(e.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(t),1)}}),e.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(t))}})),1==obj.options.allowDeleteRow&&e.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(t))}}),s&&1==obj.options.allowComments){e.push({type:"line"});var n=obj.records[t][s].getAttribute("title")||"";e.push({title:n?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var r=prompt(obj.options.text.comments,n);r&&obj.setComments([s,t],r)}}),n&&e.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([s,t],"")}})}return e.push({type:"line"}),e.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&e.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(t){t&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],t)})}}),obj.options.allowExport&&e.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&e.push({title:obj.options.text.about,onclick:function(){alert(obj.options.about)}}),e},obj.scrollControls=function(t){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop-=obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(10>obj.content.scrollTop&&(obj.content.scrollTop+=obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100)),1!=obj.options.lazyLoading&&1!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=t.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},el.addEventListener("DOMMouseScroll",obj.scrollControls),el.addEventListener("mousewheel",obj.scrollControls),el.jexcel=obj,obj.init(),obj};jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null,jexcel.destroy=function(n,e){n.jexcel&&(n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",e&&(document.removeEventListener("keydown",jexcel.keyDownControls),document.removeEventListener("mouseup",jexcel.mouseUpControls),document.removeEventListener("mousedown",jexcel.mouseDownControls),document.removeEventListener("mousemove",jexcel.mouseMoveControls),document.removeEventListener("mouseover",jexcel.mouseOverControls),document.removeEventListener("dblclick",jexcel.doubleClickControls),document.removeEventListener("paste",jexcel.pasteControls),document.removeEventListener("contextmenu",jexcel.contextMenuControls),document.removeEventListener("touchstart",jexcel.touchStartControls),document.removeEventListener("touchend",jexcel.touchEndControls),document.removeEventListener("touchcancel",jexcel.touchEndControls),jexcel=null))},jexcel.build=function(){document.addEventListener("keydown",jexcel.keyDownControls),document.addEventListener("mouseup",jexcel.mouseUpControls),document.addEventListener("mousedown",jexcel.mouseDownControls),document.addEventListener("mousemove",jexcel.mouseMoveControls),document.addEventListener("mouseover",jexcel.mouseOverControls),document.addEventListener("dblclick",jexcel.doubleClickControls),document.addEventListener("paste",jexcel.pasteControls),document.addEventListener("contextmenu",jexcel.contextMenuControls),document.addEventListener("touchstart",jexcel.touchStartControls),document.addEventListener("touchend",jexcel.touchEndControls),document.addEventListener("touchcancel",jexcel.touchEndControls),document.addEventListener("touchmove",jexcel.touchEndControls)},jexcel.keyDownControls=function(s){if(jexcel.current){if(jexcel.current.edition)if(27==s.which)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),s.preventDefault();else if(!(13==s.which))9==s.which&&("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.edition[0].children[0].calendar.close(1):jexcel.current.edition[0].children[0].blur());else if("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type)jexcel.current.editor[0].children[0].calendar.close(1);else if("dropdown"==jexcel.current.options.columns[jexcel.current.edition[2]].type||"autocomplete"==jexcel.current.options.columns[jexcel.current.edition[2]].type);else if((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||200<jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length)&&s.altKey){var e=jexcel.current.edition[0].children[0],t=jexcel.current.edition[0].children[0].value,i=e.selectionStart;t=t.slice(0,i)+"\n"+t.slice(i),e.value=t,e.focus(),e.selectionStart=i+1,e.selectionEnd=i+1}else jexcel.current.edition[0].children[0].blur();if(jexcel.current.edition||!jexcel.current.selectedCell)s.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(s.target.value)},200));else if(37==s.which)jexcel.current.left(s.shiftKey,s.ctrlKey),s.preventDefault();else if(39==s.which)jexcel.current.right(s.shiftKey,s.ctrlKey),s.preventDefault();else if(38==s.which)jexcel.current.up(s.shiftKey,s.ctrlKey),s.preventDefault();else if(40==s.which)jexcel.current.down(s.shiftKey,s.ctrlKey),s.preventDefault();else if(36==s.which)jexcel.current.first(s.shiftKey,s.ctrlKey),s.preventDefault();else if(35==s.which)jexcel.current.last(s.shiftKey,s.ctrlKey),s.preventDefault();else if(32==s.which)1==jexcel.current.options.editable&&jexcel.current.setCheckRadioValue(),s.preventDefault();else if(46==s.which)1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(13==s.which)s.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),s.preventDefault();else if(9==s.which)s.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),s.preventDefault();else if((s.ctrlKey||s.metaKey)&&!s.shiftKey)65==s.which?(jexcel.current.selectAll(),s.preventDefault()):83==s.which?(jexcel.current.download(),s.preventDefault()):89==s.which?(jexcel.current.redo(),s.preventDefault()):90==s.which?(jexcel.current.undo(),s.preventDefault()):67==s.which?(jexcel.current.copy(!0),s.preventDefault()):67==s.which?(jexcel.current.copy(!0),s.preventDefault()):88==s.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),s.preventDefault()):86==s.which&&jexcel.pasteControls();else if(jexcel.current.selectedCell&&1==jexcel.current.options.editable){var r=jexcel.current.selectedCell[1],n=jexcel.current.selectedCell[0];"readonly"!=jexcel.current.options.columns[n].type&&(32==s.keyCode?"checkbox"==jexcel.current.options.columns[n].type||"radio"==jexcel.current.options.columns[n].type?s.preventDefault():jexcel.current.openEditor(jexcel.current.records[r][n],!0):113==s.keyCode?jexcel.current.openEditor(jexcel.current.records[r][n],!1):(8==s.keyCode||48<=s.keyCode&&57>=s.keyCode||96<=s.keyCode&&111>=s.keyCode||187==s.keyCode||189==s.keyCode||(_StringfromCharCode(s.keyCode)==s.key||_StringfromCharCode(s.keyCode).toLowerCase()==s.key.toLowerCase())&&jexcel.validLetter(_StringfromCharCode(s.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[r][n],!0),"calendar"==jexcel.current.options.columns[n].type&&s.preventDefault()))}}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(g){if((g=g||window.event).buttons)var m=g.buttons;else m=g.button?g.button:g.which;var h=jexcel.getElement(g.target);if(h[0]?jexcel.current!=h[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=h[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==m){if(g.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(g.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(!(1==h[1]))jexcel.current.selectedHeader=!1;else if(p=g.target.getAttribute("data-x")){var o=g.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&6>o.width-g.offsetX){jexcel.current.resizing={mousePosition:g.pageX,column:p,width:o.width},jexcel.current.headers[p].classList.add("resizing");for(var C=0;C<jexcel.current.records.length;C++)jexcel.current.records[C][p]&&jexcel.current.records[C][p].classList.add("resizing")}else if(!(1==jexcel.current.options.columnDrag&&6>o.height-g.offsetY)){if(jexcel.current.selectedHeader&&(g.shiftKey||g.ctrlKey))var f=jexcel.current.selectedHeader,y=p;else jexcel.current.selectedHeader==p&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(p)},800)),jexcel.current.selectedHeader=p,f=p,y=p;jexcel.current.updateSelectionFromCoords(f,0,y,jexcel.current.options.data.length-1)}else if(jexcel.current.isColMerged(p).length)console.error("JEXCEL: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:g.target,column:p,destination:p},jexcel.current.headers[p].classList.add("dragging"),C=0;C<jexcel.current.records.length;C++)jexcel.current.records[C][p]&&jexcel.current.records[C][p].classList.add("dragging")}else if(g.target.parentNode.classList.contains("jexcel_nested")){if(g.target.getAttribute("data-column"))var N=g.target.getAttribute("data-column").split(","),i=parseInt(N[0]),E=parseInt(N[N.length-1]);else i=0,E=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(i,0,E,jexcel.current.options.data.length-1)}if(2==h[1]){var A=g.target.getAttribute("data-y");if(g.target.classList.contains("jexcel_row"))o=g.target.getBoundingClientRect(),1==jexcel.current.options.rowResize&&6>o.height-g.offsetY?(jexcel.current.resizing={element:g.target.parentNode,mousePosition:g.pageY,row:A,height:o.height},g.target.parentNode.classList.add("resizing")):1==jexcel.current.options.rowDrag&&6>o.width-g.offsetX?jexcel.current.isRowMerged(A).length?console.error("JEXCEL: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("JEXCEL: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:g.target.parentNode,row:A,destination:A},g.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(g.shiftKey||g.ctrlKey)?(f=jexcel.current.selectedRow,y=A):(jexcel.current.selectedRow=A,f=A,y=A),jexcel.current.updateSelectionFromCoords(0,f,jexcel.current.options.data[0].length-1,y));else if(g.target.classList.contains("jclose")&&50>g.target.clientWidth-g.offsetX&&50>g.offsetY)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var w=function(n){var e=n.getAttribute("data-x"),t=n.getAttribute("data-y");return e&&t?[e,t]:n.parentNode?w(n.parentNode):void 0},b=w(g.target);if(b){var p=b[0];A=b[1],jexcel.current.edition&&(jexcel.current.edition[2]==p&&jexcel.current.edition[3]==A||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(g.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],p,A):jexcel.current.updateSelectionFromCoords(p,A)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;g.target.classList.contains("jexcel_page")&&("<"==g.target.innerText?jexcel.current.page(0):">"==g.target.innerText?jexcel.current.page(g.target.getAttribute("title")-1):jexcel.current.page(g.target.innerText-1))}jexcel.isMouseAction=!jexcel.current.edition}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(i){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");var e=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width");jexcel.current.setWidth(jexcel.current.resizing.column,e,jexcel.current.resizing.width),jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var t=0;t<jexcel.current.records.length;t++)jexcel.current.records[t][jexcel.current.resizing.column]&&jexcel.current.records[t][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var a=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,a,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(!jexcel.current.dragging)jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,0<jexcel.current.selection.length&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));else if(jexcel.current.dragging){if(jexcel.current.dragging.column){var r=i.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),t=0;t<jexcel.current.rows.length;t++)jexcel.current.records[t][jexcel.current.dragging.column]&&jexcel.current.records[t][jexcel.current.dragging.column].classList.remove("dragging");for(var n=0;n<jexcel.current.headers.length;n++)jexcel.current.headers[n].classList.remove("dragging-left"),jexcel.current.headers[n].classList.remove("dragging-right");r&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{var d=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element);jexcel.current.dragging.row!=d&&jexcel.current.moveRow(jexcel.current.dragging.row,d,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(d){if((d=d||window.event).buttons)var u=d.buttons;else u=d.button?d.button:d.which;if(u||(jexcel.isMouseAction=!1),jexcel.current)if(1!=jexcel.isMouseAction){var c=d.target.getAttribute("data-x"),s=d.target.getAttribute("data-y"),i=d.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),d.target.parentNode.parentNode&&d.target.parentNode.parentNode.className&&(d.target.parentNode.parentNode.classList.contains("resizable")&&(d.target&&c&&!s&&6>i.width-(d.clientX-i.left)?(jexcel.current.cursor=d.target,jexcel.current.cursor.style.cursor="col-resize"):d.target&&!c&&s&&6>i.height-(d.clientY-i.top)&&(jexcel.current.cursor=d.target,jexcel.current.cursor.style.cursor="row-resize")),d.target.parentNode.parentNode.classList.contains("draggable")&&(d.target&&!c&&s&&6>i.width-(d.clientX-i.left)?(jexcel.current.cursor=d.target,jexcel.current.cursor.style.cursor="move"):d.target&&c&&!s&&6>i.height-(d.clientY-i.top)&&(jexcel.current.cursor=d.target,jexcel.current.cursor.style.cursor="move")))}else if(jexcel.current.resizing)if(jexcel.current.resizing.column){var a=d.pageX-jexcel.current.resizing.mousePosition;if(0<jexcel.current.resizing.width+a){var o=jexcel.current.resizing.width+a;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",o),jexcel.current.updateCornerPosition()}}else{var r=d.pageY-jexcel.current.resizing.mousePosition;if(0<jexcel.current.resizing.height+r){var n=jexcel.current.resizing.height+r;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",n),jexcel.current.updateCornerPosition()}}},jexcel.mouseOverControls=function(d){if((d=d||window.event).buttons)var u=d.buttons;else u=d.button?d.button:d.which;if(u||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){var c=jexcel.getElement(d.target);if(c[0]){if(jexcel.current!=c[0].jexcel&&jexcel.current)return!1;var o=d.target.getAttribute("data-x"),p=d.target.getAttribute("data-y");if(jexcel.current.dragging){if(jexcel.current.dragging.column){if(o)if(jexcel.current.isColMerged(o).length)console.error("JEXCEL: This column is part of a merged cell.");else{for(var n=0;n<jexcel.current.headers.length;n++)jexcel.current.headers[n].classList.remove("dragging-left"),jexcel.current.headers[n].classList.remove("dragging-right");jexcel.current.dragging.column==o?jexcel.current.dragging.destination=parseInt(o):d.target.clientWidth/2>d.offsetX?(jexcel.current.dragging.destination=jexcel.current.dragging.column<o?parseInt(o)-1:parseInt(o),jexcel.current.headers[o].classList.add("dragging-left")):(jexcel.current.dragging.destination=jexcel.current.dragging.column<o?parseInt(o):parseInt(o)+1,jexcel.current.headers[o].classList.add("dragging-right"))}}else if(p)if(jexcel.current.isRowMerged(p).length)console.error("JEXCEL: This row is part of a merged cell.");else{var g=d.target.clientHeight/2>d.offsetY?d.target.parentNode.nextSibling:d.target.parentNode;d.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,g)}}else if(jexcel.current.resizing);else{if(1==c[1]&&jexcel.current.selectedHeader){o=d.target.getAttribute("data-x");var s=jexcel.current.selectedHeader,m=o;jexcel.current.updateSelectionFromCoords(s,0,m,jexcel.current.options.data.length-1)}2==c[1]&&(d.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(s=jexcel.current.selectedRow,m=p,jexcel.current.updateSelectionFromCoords(0,s,jexcel.current.options.data[0].length-1,m)):jexcel.current.edition||o&&p&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(o,p):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o,p)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(d){if(jexcel.current)if(!d.target.classList.contains("jexcel_corner")){var e=jexcel.getElement(d.target);if(1==e[1]&&1==jexcel.current.options.columnSorting){var l=d.target.getAttribute("data-x");l&&jexcel.current.orderBy(l)}if(2==e[1]&&1==jexcel.current.options.editable&&!jexcel.current.edition){var s=function(n){if(n.parentNode){var e=n.getAttribute("data-x"),t=n.getAttribute("data-y");return e&&t?n:s(n.parentNode)}},i=s(d.target);i&&i.classList.contains("highlight")&&jexcel.current.openEditor(i)}}else if(0<jexcel.current.highlighted.length){var a=jexcel.current.highlighted[0].getAttribute("data-x"),t=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,o=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),r=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[t][a],jexcel.current.records[r][o])}},jexcel.copyControls=function(){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(t){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(t&&t.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],t.clipboardData.getData("text")),t.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current)if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var s=n.target.getAttribute("data-x"),t=n.target.getAttribute("data-y");if(s||t){var o=jexcel.current.options.contextMenu(jexcel.current,s,t,n);jexcel.current.contextMenu.contextmenu.open(n,o),n.preventDefault()}}},jexcel.touchStartControls=function(n){var e=jexcel.getElement(n.target);if(e[0]?jexcel.current!=e[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=e[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var t=n.target.getAttribute("data-x"),o=n.target.getAttribute("data-y");t&&o&&(jexcel.current.updateSelectionFromCoords(t,o),jexcel.timeControl=setTimeout(function(){jexcel.tmpElement="color"==jexcel.current.options.columns[t].type?null:n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.createTabs=function(s,e){s.innerHTML="",s.classList.add("jexcel_tabs");for(var l=[],o=[],t=0;t<e.length;t++)l[t]=document.createElement("div"),l[t].classList.add("jexcel_tab"),o[t]=document.createElement("div"),o[t].classList.add("jexcel_tab_link"),o[t].setAttribute("data-spreadsheet",t),o[t].innerHTML=e[t].sheetName,o[t].onclick=function(){for(var n=0;n<l.length;n++)l[n].style.display="none",o[n].classList.remove("selected");var r=this.getAttribute("data-spreadsheet");l[r].style.display="block",o[r].classList.add("selected")},s.appendChild(o[t]);for(t=0;t<l.length-1;t++)s.appendChild(l[t]),jexcel(l[t],e[t]);l[0].style.display="block",o[0].classList.add("selected")},jexcel.fromSpreadsheet=function(n,i){var t=function(m){var e=[];return m.SheetNames.forEach(function(t){var o={rows:[],columns:[],data:[],style:{}};if(o.sheetName=t,(y=m.Sheets[t]["!cols"])&&y.length)for(var r=0;r<y.length;r++)o.columns[r]={},y[r]&&y[r].wpx&&(o.columns[r].width=y[r].wpx+"px");if((y=m.Sheets[t]["!rows"])&&y.length)for(r=0;r<y.length;r++)y[r]&&y[r].hpx&&(o.rows[r]={},o.rows[r].height=y[r].hpx+"px");if((y=m.Sheets[t]["!merges"])&&0<y.length)for(o.mergeCells=[],r=0;r<y.length;r++){var h=y[r].s.c,l=y[r].s.r,s=y[r].e.c,i=y[r].e.r,a=jexcel.getColumnNameFromId([h,l]);o.mergeCells[a]=[s-h+1,i-l+1]}var u=0,C=0,y=Object.keys(m.Sheets[t]);for(r=0;r<y.length;r++)if("!"!=y[r].substr(0,1)){var N=m.Sheets[t][y[r]],d=jexcel.getIdFromColumnName(y[r],!0);o.data[d[1]]||(o.data[d[1]]=[]),o.data[d[1]][d[0]]=N.f?"="+N.f:N.w,u<d[0]&&(u=d[0]),C<d[1]&&(C=d[1]),N.style&&0<Object.keys(N.style).length&&(o.style[y[r]]=N.style),N.s&&N.s.fgColor&&(o.style[y[r]]&&(o.style[y[r]]+=";"),o.style[y[r]]+="background-color:#"+N.s.fgColor.rgb)}for(var E=o.columns,f=0;f<=C;f++)for(r=0;r<=u;r++)o.data[f]||(o.data[f]=[]),o.data[f][r]||E<r&&(o.data[f][r]="");e.push(o)}),e},r;(r=new XMLHttpRequest).open("GET",n,!0),"undefined"==typeof Uint8Array?(r.setRequestHeader("Accept-Charset","x-user-defined"),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var o=convertResponseBodyToText(r.responseBody),e=XLSX.read(o,{type:"binary",cellFormula:!0,cellStyles:!0});i(t(e))}}):(r.responseType="arraybuffer",r.onload=function(){var e=r.response,n=new Uint8Array(e),o=XLSX.read(n,{type:"array",cellFormula:!0,cellStyles:!0});i(t(o))}),r.send()},jexcel.validLetter=function(t){return t.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,e,t){return n.slice(0,e).concat(t).concat(n.slice(e))},jexcel.getColumnName=function(n){var e="";return 701<n?(e+=_StringfromCharCode(64+parseInt(n/676)),e+=_StringfromCharCode(64+parseInt(n%676/26))):25<n&&(e+=_StringfromCharCode(64+parseInt(n/26))),e+=_StringfromCharCode(65+n%26)},jexcel.getIdFromColumnName=function(s,i){var t=/^[a-zA-Z]+/.exec(s);if(t){for(var o=0,a=0;a<t[0].length;a++)o+=parseInt(t[0].charCodeAt(a)-64)*_Mathpow(26,t[0].length-1-a);0>--o&&(o=0);var d=parseInt(/[0-9]+$/.exec(s));0<d&&d--,s=1==i?[o,d]:o+"-"+d}return s},jexcel.getColumnNameFromId=function(t){return Array.isArray(t)||(t=t.split("-")),jexcel.getColumnName(parseInt(t[0]))+(parseInt(t[1])+1)},jexcel.getElement=function(n){var s=0,l=0;return function t(e){e.className&&e.classList.contains("jexcel_container")&&(l=e),"THEAD"==e.tagName?s=1:"TBODY"==e.tagName&&(s=2),e.parentNode&&t(e.parentNode)}(n),[l,s]},jexcel.doubleDigitFormat=function(t){return 1==(t=""+t).length&&(t="0"+t),t},"undefined"!=typeof jQuery&&function(n){n.fn.jexcel=function(e){var t=n(this).get(0);return t.jexcel?t.jexcel[e].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery);var error=(exports={},exports.nil=new Error("#NULL!"),exports.div0=new Error("#DIV/0!"),exports.value=new Error("#VALUE!"),exports.ref=new Error("#REF!"),exports.name=new Error("#NAME?"),exports.num=new Error("#NUM!"),exports.na=new Error("#N/A"),exports.error=new Error("#ERROR!"),exports.data=new Error("#GETTING_DATA"),exports),utils=function(){var n={flattenShallow:function(t){return t&&t.reduce?t.reduce(function(n,e){var t=Array.isArray(n),o=Array.isArray(e);return t&&o?n.concat(e):t?(n.push(e),n):o?[n].concat(e):[n,e]}):t},isFlat:function(n){if(!n)return!1;for(var e=0;e<n.length;++e)if(Array.isArray(n[e]))return!1;return!0},flatten:function(){for(var e=n.argsToArray.apply(null,arguments);!n.isFlat(e);)e=n.flattenShallow(e);return e},argsToArray:function(e){var t=[];return n.arrayEach(e,function(n){t.push(n)}),t},numbers:function(){return this.flatten.apply(null,arguments).filter(function(t){return"number"==typeof t})},cleanFloat:function(t){return _Mathround(1e14*t)/1e14},parseBool:function(n){if("boolean"==typeof n)return n;if(n instanceof Error)return n;if("number"==typeof n)return 0!==n;if("string"==typeof n){var e=n.toUpperCase();if("TRUE"===e)return!0;if("FALSE"===e)return!1}return n instanceof Date&&!isNaN(n)||error.value},parseNumber:function(t){return void 0===t||""===t?error.value:isNaN(t)?error.value:parseFloat(t)},parseNumberArray:function(e){var t,s;if(!e||0===(t=e.length))return error.value;for(;t--;){if((s=n.parseNumber(e[t]))===error.value)return s;e[t]=s}return e},parseMatrix:function(e){var t;if(!e||0===e.length)return error.value;for(var s=0;s<e.length;s++)if(t=n.parseNumberArray(e[s]),e[s]=t,t instanceof Error)return t;return e}},r=new Date(Date.UTC(1900,0,1));return n.parseDate=function(t){if(!isNaN(t)){if(t instanceof Date)return new Date(t);var n=parseInt(t,10);return 0>n?error.num:60>=n?new Date(r.getTime()+864e5*(n-1)):new Date(r.getTime()+864e5*(n-2))}return"string"!=typeof t||(t=new Date(t),isNaN(t))?error.value:t},n.parseDateArray=function(n){for(var e=n.length,r;e--;){if((r=this.parseDate(n[e]))===error.value)return r;n[e]=r}return n},n.anyIsError=function(){for(var t=arguments.length;t--;)if(arguments[t]instanceof Error)return!0;return!1},n.arrayValuesToNumbers=function(n){for(var e=n.length,s;e--;)if("number"!=typeof(s=n[e]))if(!(!0!==s))n[e]=1;else if(!(!1!==s))n[e]=0;else if("string"==typeof s){var l=this.parseNumber(s);n[e]=l instanceof Error?0:l}return n},n.rest=function(n,e){return e=e||1,n&&"function"==typeof n.slice?n.slice(e):n},n.initial=function(n,e){return e=e||1,n&&"function"==typeof n.slice?n.slice(0,n.length-e):n},n.arrayEach=function(n,e){for(var t=-1,s=n.length;++t<s&&!1!==e(n[t],t,n););return n},n.transpose=function(n){return n?n[0].map(function(e,t){return n.map(function(n){return n[t]})}):error.value},n}(),exports;jexcel.methods={},jexcel.methods.datetime=function(){function n(t){return(t-s)/864e5+(-22038912e5<t?2:1)}var r={},s=new Date(1900,0,1),l=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];return r.DATE=function(n,r,s){return n=utils.parseNumber(n),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0>n||0>r||0>s?error.num:new Date(n,r-1,s)},r.DATEVALUE=function(t){if("string"!=typeof t)return error.value;var e=Date.parse(t);return isNaN(e)?error.value:-22038912e5>=e?(e-s)/864e5+1:(e-s)/864e5+2},r.DAY=function(n){var e=utils.parseDate(n);return e instanceof Error?e:e.getDate()},r.DAYS=function(r,o){return r=utils.parseDate(r),o=utils.parseDate(o),r instanceof Error?r:o instanceof Error?o:n(r)-n(o)},r.DAYS360=function(){},r.EDATE=function(r,o){return(r=utils.parseDate(r))instanceof Error?r:isNaN(o)?error.value:(o=parseInt(o,10),r.setMonth(r.getMonth()+o),n(r))},r.EOMONTH=function(r,o){return(r=utils.parseDate(r))instanceof Error?r:isNaN(o)?error.value:(o=parseInt(o,10),n(new Date(r.getFullYear(),r.getMonth()+o+1,0)))},r.HOUR=function(t){return(t=utils.parseDate(t))instanceof Error?t:t.getHours()},r.INTERVAL=function(i){if("number"!=typeof i&&"string"!=typeof i)return error.value;i=parseInt(i,10);var a=_Mathfloor(i/94608e4);i%=94608e4;var d=_Mathfloor(i/2592e3);i%=2592e3;var u=_Mathfloor(i/86400);i%=86400;var c=_Mathfloor(i/3600);i%=3600;var p=_Mathfloor(i/60),g=i%=60;return"P"+(a=0<a?a+"Y":"")+(d=0<d?d+"M":"")+(u=0<u?u+"D":"")+"T"+(c=0<c?c+"H":"")+(p=0<p?p+"M":"")+(g=0<g?g+"S":"")},r.ISOWEEKNUM=function(n){if((n=utils.parseDate(n))instanceof Error)return n;n.setHours(0,0,0),n.setDate(n.getDate()+4-(n.getDay()||7));var r=new Date(n.getFullYear(),0,1);return _Mathceil(((n-r)/864e5+1)/7)},r.MINUTE=function(t){return(t=utils.parseDate(t))instanceof Error?t:t.getMinutes()},r.MONTH=function(t){return(t=utils.parseDate(t))instanceof Error?t:t.getMonth()+1},r.NETWORKDAYS=function(){},r.NETWORKDAYS.INTL=function(){},r.NOW=function(){return new Date},r.SECOND=function(t){return(t=utils.parseDate(t))instanceof Error?t:t.getSeconds()},r.TIME=function(n,r,s){return n=utils.parseNumber(n),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0>n||0>r||0>s?error.num:(3600*n+60*r+s)/86400},r.TIMEVALUE=function(t){return(t=utils.parseDate(t))instanceof Error?t:(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},r.TODAY=function(){return new Date},r.WEEKDAY=function(n,o){if((n=utils.parseDate(n))instanceof Error)return n;void 0===o&&(o=1);var s=n.getDay();return l[o][s]},r.WEEKNUM=function(){},r.WORKDAY=function(){},r.WORKDAY.INTL=function(){},r.YEAR=function(t){return(t=utils.parseDate(t))instanceof Error?t:t.getFullYear()},r.YEARFRAC=function(){},r}(),jexcel.methods.database=function(){function compact(n){if(!n)return n;for(var e=[],t=0;t<n.length;++t)n[t]&&e.push(n[t]);return e}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0,criteria;j<criterias.length;++j)if(criteria=criterias[j],!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}var exports={};return exports.FINDFIELD=function(n,e){for(var t=null,s=0;s<n.length;s++)if(n[s][0]===e){t=s;break}return null==t?error.value:t},exports.DAVERAGE=function(a,e,t){if(isNaN(e)&&"string"!=typeof e)return error.value;var o=findResultIndex(a,t),r=[];if("string"==typeof e){var d=exports.FINDFIELD(a,e);r=utils.rest(a[d])}else r=utils.rest(a[e]);for(var l=0,u=0;u<o.length;u++)l+=r[o[u]];return 0===o.length?error.div0:l/o.length},exports.DCOUNT=function(){},exports.DCOUNTA=function(){},exports.DGET=function(s,e,t){if(isNaN(e)&&"string"!=typeof e)return error.value;var o=findResultIndex(s,t),r=[];if("string"==typeof e){var i=exports.FINDFIELD(s,e);r=utils.rest(s[i])}else r=utils.rest(s[e]);return 0===o.length?error.value:1<o.length?error.num:r[o[0]]},exports.DMAX=function(a,e,t){if(isNaN(e)&&"string"!=typeof e)return error.value;var o=findResultIndex(a,t),r=[];if("string"==typeof e){var d=exports.FINDFIELD(a,e);r=utils.rest(a[d])}else r=utils.rest(a[e]);for(var l=r[o[0]],u=1;u<o.length;u++)l<r[o[u]]&&(l=r[o[u]]);return l},exports.DMIN=function(a,e,t){if(isNaN(e)&&"string"!=typeof e)return error.value;var o=findResultIndex(a,t),r=[];if("string"==typeof e){var d=exports.FINDFIELD(a,e);r=utils.rest(a[d])}else r=utils.rest(a[e]);for(var l=r[o[0]],u=1;u<o.length;u++)l>r[o[u]]&&(l=r[o[u]]);return l},exports.DPRODUCT=function(d,e,t){if(isNaN(e)&&"string"!=typeof e)return error.value;var o=findResultIndex(d,t),r=[];if("string"==typeof e){var u=exports.FINDFIELD(d,e);r=utils.rest(d[u])}else r=utils.rest(d[e]);for(var l=[],c=0;c<o.length;c++)l[c]=r[o[c]];l=compact(l);var p=1;for(c=0;c<l.length;c++)p*=l[c];return p},exports.DSTDEV=function(){},exports.DSTDEVP=function(){},exports.DSUM=function(){},exports.DVAR=function(){},exports.DVARP=function(){},exports.MATCH=function(s,i,t){if(!s&&!i)return error.na;if(2===arguments.length&&(t=1),!(i instanceof Array))return error.na;if(-1!==t&&0!==t&&1!==t)return error.na;for(var a=0,d,u;a<i.length;a++)if(1===t){if(i[a]===s)return a+1;i[a]<s&&(u?i[a]>u&&(d=a+1,u=i[a]):(d=a+1,u=i[a]))}else if(0===t){if("string"==typeof s){if(s=s.replace(/\?/g,"."),i[a].toLowerCase().match(s.toLowerCase()))return a+1;}else if(i[a]===s)return a+1;}else if(-1===t){if(i[a]===s)return a+1;i[a]>s&&(u?i[a]<u&&(d=a+1,u=i[a]):(d=a+1,u=i[a]))}return d||error.na},exports}(),jexcel.methods.engineering=function(){function s(t){return /^[01]{1,10}$/.test(t)}var d={};return d.BESSELI=function(){},d.BESSELJ=function(){},d.BESSELK=function(){},d.BESSELY=function(){},d.BIN2DEC=function(t){if(!s(t))return error.num;var e=parseInt(t,2),n=t.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:e},d.BIN2HEX=function(t,e){if(!s(t))return error.num;var l=t.toString();if(10===l.length&&"1"===l.substring(0,1))return(0xfffffffe00+parseInt(l.substring(1),2)).toString(16);var r=parseInt(t,2).toString(16);return void 0===e?r:isNaN(e)?error.value:0>e?error.num:(e=_Mathfloor(e))>=r.length?REPT("0",e-r.length)+r:error.num},d.BIN2OCT=function(t,e){if(!s(t))return error.num;var l=t.toString();if(10===l.length&&"1"===l.substring(0,1))return(1073741312+parseInt(l.substring(1),2)).toString(8);var r=parseInt(t,2).toString(8);return void 0===e?r:isNaN(e)?error.value:0>e?error.num:(e=_Mathfloor(e))>=r.length?REPT("0",e-r.length)+r:error.num},d.BITAND=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0>n||0>r?error.num:_Mathfloor(n)!==n||_Mathfloor(r)!==r?error.num:0xffffffffffff<n||0xffffffffffff<r?error.num:n&r},d.BITLSHIFT=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0>n?error.num:_Mathfloor(n)===n?0xffffffffffff<n?error.num:53<_Mathabs(r)?error.num:0<=r?n<<r:n>>-r:error.num},d.BITOR=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0>n||0>r?error.num:_Mathfloor(n)!==n||_Mathfloor(r)!==r?error.num:0xffffffffffff<n||0xffffffffffff<r?error.num:n|r},d.BITRSHIFT=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0>n?error.num:_Mathfloor(n)===n?0xffffffffffff<n?error.num:53<_Mathabs(r)?error.num:0<=r?n>>r:n<<-r:error.num},d.BITXOR=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0>n||0>r?error.num:_Mathfloor(n)!==n||_Mathfloor(r)!==r?error.num:0xffffffffffff<n||0xffffffffffff<r?error.num:n^r},d.COMPLEX=function(n,s,l){if(n=utils.parseNumber(n),s=utils.parseNumber(s),utils.anyIsError(n,s))return n;if("i"!==(l=void 0===l?"i":l)&&"j"!==l)return error.value;if(0===n&&0===s)return 0;if(0===n)return 1===s?l:s.toString()+l;if(0===s)return n.toString();var i=0<s?"+":"";return n.toString()+i+(1===s?l:s.toString()+l)},d.CONVERT=function(C,y,t){if((C=utils.parseNumber(C))instanceof Error)return C;for(var o=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],n={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},s=null,N=null,E=y,A=t,w=1,I=1,L=0,R;L<o.length;L++)R=null===o[L][2]?[]:o[L][2],(o[L][1]===E||0<=R.indexOf(E))&&(s=o[L]),(o[L][1]===A||0<=R.indexOf(A))&&(N=o[L]);if(null===s){var S=n[y.substring(0,2)],M=l[y.substring(0,1)];"da"===y.substring(0,2)&&(M=["dekao",10,"da"]),S?(w=S[2],E=y.substring(2)):M&&(w=M[1],E=y.substring(M[2].length));for(var T=0;T<o.length;T++)R=null===o[T][2]?[]:o[T][2],(o[T][1]===E||0<=R.indexOf(E))&&(s=o[T])}if(null===N){var x=n[t.substring(0,2)],h=l[t.substring(0,1)];"da"===t.substring(0,2)&&(h=["dekao",10,"da"]),x?(I=x[2],A=t.substring(2)):h&&(I=h[1],A=t.substring(h[2].length));for(var D=0;D<o.length;D++)R=null===o[D][2]?[]:o[D][2],(o[D][1]===A||0<=R.indexOf(A))&&(N=o[D])}return null===s||null===N?error.na:s[3]===N[3]?C*s[6]*w/(N[6]*I):error.na},d.DEC2BIN=function(n,r){if((n=utils.parseNumber(n))instanceof Error)return n;if(!/^-?[0-9]{1,3}$/.test(n)||-512>n||511<n)return error.num;if(0>n)return"1"+REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2);var s=parseInt(n,10).toString(2);return void 0===r?s:isNaN(r)?error.value:0>r?error.num:(r=_Mathfloor(r))>=s.length?REPT("0",r-s.length)+s:error.num},d.DEC2HEX=function(n,r){if((n=utils.parseNumber(n))instanceof Error)return n;if(!/^-?[0-9]{1,12}$/.test(n)||-549755813888>n||549755813887<n)return error.num;if(0>n)return(1099511627776+n).toString(16);var s=parseInt(n,10).toString(16);return void 0===r?s:isNaN(r)?error.value:0>r?error.num:(r=_Mathfloor(r))>=s.length?REPT("0",r-s.length)+s:error.num},d.DEC2OCT=function(n,r){if((n=utils.parseNumber(n))instanceof Error)return n;if(!/^-?[0-9]{1,9}$/.test(n)||-536870912>n||536870911<n)return error.num;if(0>n)return(1073741824+n).toString(8);var s=parseInt(n,10).toString(8);return void 0===r?s:isNaN(r)?error.value:0>r?error.num:(r=_Mathfloor(r))>=s.length?REPT("0",r-s.length)+s:error.num},d.DELTA=function(n,r){return r=void 0===r?0:r,n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:n===r?1:0},d.ERF=function(){},d.ERF.PRECISE=function(){},d.ERFC=function(){},d.ERFC.PRECISE=function(){},d.GESTEP=function(n,r){return r=r||0,n=utils.parseNumber(n),utils.anyIsError(r,n)?n:n>=r?1:0},d.HEX2BIN=function(s,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(s))return error.num;var l=10===s.length&&"f"===s.substring(0,1).toLowerCase(),o=l?parseInt(s,16)-1099511627776:parseInt(s,16);if(-512>o||511<o)return error.num;if(l)return"1"+REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var r=o.toString(2);return void 0===e?r:isNaN(e)?error.value:0>e?error.num:(e=_Mathfloor(e))>=r.length?REPT("0",e-r.length)+r:error.num},d.HEX2DEC=function(n){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return error.num;var e=parseInt(n,16);return 549755813888<=e?e-1099511627776:e},d.HEX2OCT=function(n,e){if(!/^[0-9A-Fa-f]{1,10}$/.test(n))return error.num;var s=parseInt(n,16);if(536870911<s&&0xffe0000000>s)return error.num;if(0xffe0000000<=s)return(s-0xffc0000000).toString(8);var o=s.toString(8);return void 0===e?o:isNaN(e)?error.value:0>e?error.num:(e=_Mathfloor(e))>=o.length?REPT("0",e-o.length)+o:error.num},d.IMABS=function(e){var t=d.IMREAL(e),n=d.IMAGINARY(e);return utils.anyIsError(t,n)?error.value:_Mathsqrt(_Mathpow(t,2)+_Mathpow(n,2))},d.IMAGINARY=function(s){if(void 0===s||!0===s||!1===s)return error.value;if(0===s||"0"===s)return 0;if(0<=["i","j"].indexOf(s))return 1;var l=(s=s.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),i=s.indexOf("-");0===l&&(l=s.indexOf("+",1)),0===i&&(i=s.indexOf("-",1));var a=s.substring(s.length-1,s.length),r="i"===a||"j"===a;return 0<=l||0<=i?r?0<=l?isNaN(s.substring(0,l))||isNaN(s.substring(l+1,s.length-1))?error.num:+s.substring(l+1,s.length-1):isNaN(s.substring(0,i))||isNaN(s.substring(i+1,s.length-1))?error.num:-+s.substring(i+1,s.length-1):error.num:r?isNaN(s.substring(0,s.length-1))?error.num:s.substring(0,s.length-1):isNaN(s)?error.num:0},d.IMARGUMENT=function(e){var t=d.IMREAL(e),n=d.IMAGINARY(e);return utils.anyIsError(t,n)?error.value:0===t&&0===n?error.div0:0===t&&0<n?_MathPI/2:0===t&&0>n?-_MathPI/2:0===n&&0<t?0:0===n&&0>t?-_MathPI:0<t?_Mathatan(n/t):0>t&&0<=n?_Mathatan(n/t)+_MathPI:_Mathatan(n/t)-_MathPI},d.IMCONJUGATE=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",0===o?e:d.COMPLEX(t,-o,r)},d.IMCOS=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",d.COMPLEX(_Mathcos(t)*(_Mathexp(o)+_Mathexp(-o))/2,-_Mathsin(t)*(_Mathexp(o)-_Mathexp(-o))/2,r)},d.IMCOSH=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",d.COMPLEX(_Mathcos(o)*(_Mathexp(t)+_Mathexp(-t))/2,_Mathsin(o)*(_Mathexp(t)-_Mathexp(-t))/2,r)},d.IMCOT=function(e){var t=d.IMREAL(e),n=d.IMAGINARY(e);return utils.anyIsError(t,n)?error.value:d.IMDIV(d.IMCOS(e),d.IMSIN(e))},d.IMDIV=function(e,t){var o=d.IMREAL(e),r=d.IMAGINARY(e),n=d.IMREAL(t),l=d.IMAGINARY(t);if(utils.anyIsError(o,r,n,l))return error.value;var s=e.substring(e.length-1),i=t.substring(t.length-1),a="i";if("j"===s?a="j":"j"===i&&(a="j"),0===n&&0===l)return error.num;var p=n*n+l*l;return d.COMPLEX((o*n+r*l)/p,(r*n-o*l)/p,a)},d.IMEXP=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);r="i"===r||"j"===r?r:"i";var s=_Mathexp(t);return d.COMPLEX(s*_Mathcos(o),s*_Mathsin(o),r)},d.IMLN=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",d.COMPLEX(_Mathlog(_Mathsqrt(t*t+o*o)),_Mathatan(o/t),r)},d.IMLOG10=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",d.COMPLEX(_Mathlog(_Mathsqrt(t*t+o*o))/_Mathlog(10),_Mathatan(o/t)/_Mathlog(10),r)},d.IMLOG2=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",d.COMPLEX(_Mathlog(_Mathsqrt(t*t+o*o))/_Mathlog(2),_Mathatan(o/t)/_Mathlog(2),r)},d.IMPOWER=function(e,t){t=utils.parseNumber(t);var a=d.IMREAL(e),r=d.IMAGINARY(e);if(utils.anyIsError(t,a,r))return error.value;var n=e.substring(e.length-1);n="i"===n||"j"===n?n:"i";var u=_Mathpow(d.IMABS(e),t),s=d.IMARGUMENT(e);return d.COMPLEX(u*_Mathcos(t*s),u*_Mathsin(t*s),n)},d.IMPRODUCT=function(){for(var e=arguments[0],i=1;i<arguments.length;i++){var a=d.IMREAL(e),r=d.IMAGINARY(e),n=d.IMREAL(arguments[i]),l=d.IMAGINARY(arguments[i]);if(utils.anyIsError(a,r,n,l))return error.value;e=d.COMPLEX(a*n-r*l,a*l+r*n)}return e},d.IMREAL=function(s){if(void 0===s||!0===s||!1===s)return error.value;if(0===s||"0"===s)return 0;if(0<=["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(s))return 0;var e=s.indexOf("+"),l=s.indexOf("-");0===e&&(e=s.indexOf("+",1)),0===l&&(l=s.indexOf("-",1));var i=s.substring(s.length-1,s.length),r="i"===i||"j"===i;return 0<=e||0<=l?r?0<=e?isNaN(s.substring(0,e))||isNaN(s.substring(e+1,s.length-1))?error.num:+s.substring(0,e):isNaN(s.substring(0,l))||isNaN(s.substring(l+1,s.length-1))?error.num:+s.substring(0,l):error.num:r?isNaN(s.substring(0,s.length-1))?error.num:0:isNaN(s)?error.num:s},d.IMSEC=function(e){if(!0===e||!1===e)return error.value;var t=d.IMREAL(e),n=d.IMAGINARY(e);return utils.anyIsError(t,n)?error.value:d.IMDIV("1",d.IMCOS(e))},d.IMSECH=function(e){var t=d.IMREAL(e),n=d.IMAGINARY(e);return utils.anyIsError(t,n)?error.value:d.IMDIV("1",d.IMCOSH(e))},d.IMSIN=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",d.COMPLEX(_Mathsin(t)*(_Mathexp(o)+_Mathexp(-o))/2,_Mathcos(t)*(_Mathexp(o)-_Mathexp(-o))/2,r)},d.IMSINH=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);return r="i"===r||"j"===r?r:"i",d.COMPLEX(_Mathcos(o)*(_Mathexp(t)-_Mathexp(-t))/2,_Mathsin(o)*(_Mathexp(t)+_Mathexp(-t))/2,r)},d.IMSQRT=function(e){var t=d.IMREAL(e),o=d.IMAGINARY(e);if(utils.anyIsError(t,o))return error.value;var r=e.substring(e.length-1);r="i"===r||"j"===r?r:"i";var i=_Mathsqrt(d.IMABS(e)),l=d.IMARGUMENT(e);return d.COMPLEX(i*_Mathcos(l/2),i*_Mathsin(l/2),r)},d.IMCSC=function(e){if(!0===e||!1===e)return error.value;var t=d.IMREAL(e),n=d.IMAGINARY(e);return utils.anyIsError(t,n)?error.num:d.IMDIV("1",d.IMSIN(e))},d.IMCSCH=function(e){if(!0===e||!1===e)return error.value;var t=d.IMREAL(e),n=d.IMAGINARY(e);return utils.anyIsError(t,n)?error.num:d.IMDIV("1",d.IMSINH(e))},d.IMSUB=function(d,e){var t=this.IMREAL(d),o=this.IMAGINARY(d),r=this.IMREAL(e),n=this.IMAGINARY(e);if(utils.anyIsError(t,o,r,n))return error.value;var l=d.substring(d.length-1),s=e.substring(e.length-1),i="i";return"j"===l?i="j":"j"===s&&(i="j"),this.COMPLEX(t-r,o-n,i)},d.IMSUM=function(){for(var i=utils.flatten(arguments),e=i[0],a=1;a<i.length;a++){var d=this.IMREAL(e),r=this.IMAGINARY(e),n=this.IMREAL(i[a]),l=this.IMAGINARY(i[a]);if(utils.anyIsError(d,r,n,l))return error.value;e=this.COMPLEX(d+n,r+l)}return e},d.IMTAN=function(e){if(!0===e||!1===e)return error.value;var t=d.IMREAL(e),n=d.IMAGINARY(e);return utils.anyIsError(t,n)?error.value:this.IMDIV(this.IMSIN(e),this.IMCOS(e))},d.OCT2BIN=function(s,e){if(!/^[0-7]{1,10}$/.test(s))return error.num;var l=10===s.length&&"7"===s.substring(0,1),o=l?parseInt(s,8)-1073741824:parseInt(s,8);if(-512>o||511<o)return error.num;if(l)return"1"+REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var r=o.toString(2);return void 0===e?r:isNaN(e)?error.value:0>e?error.num:(e=_Mathfloor(e))>=r.length?REPT("0",e-r.length)+r:error.num},d.OCT2DEC=function(n){if(!/^[0-7]{1,10}$/.test(n))return error.num;var e=parseInt(n,8);return 536870912<=e?e-1073741824:e},d.OCT2HEX=function(n,e){if(!/^[0-7]{1,10}$/.test(n))return error.num;var s=parseInt(n,8);if(536870912<=s)return"ff"+(s+3221225472).toString(16);var o=s.toString(16);return void 0===e?o:isNaN(e)?error.value:0>e?error.num:(e=_Mathfloor(e))>=o.length?REPT("0",e-o.length)+o:error.num},d}(),jexcel.methods.financial=function(){var n=Math.LN10;function d(t){return t&&t.getTime&&!isNaN(t.getTime())}function t(t){return t instanceof Date?t:new Date(t)}var c={};return c.ACCRINT=function(o,u,c,p,l,g,i){return o=t(o),u=t(u),c=t(c),d(o)&&d(u)&&d(c)?0>=p||0>=l?"#NUM!":-1===[1,2,4].indexOf(g)?"#NUM!":-1===[0,1,2,3,4].indexOf(i)?"#NUM!":c<=o?"#NUM!":(i=i||0,(l=l||0)*p*YEARFRAC(o,c,i)):"#VALUE!"},c.ACCRINTM=null,c.AMORDEGRC=null,c.AMORLINC=null,c.COUPDAYBS=null,c.COUPDAYS=null,c.COUPDAYSNC=null,c.COUPNCD=null,c.COUPNUM=null,c.COUPPCD=null,c.CUMIPMT=function(e,d,p,g,m,l){if(e=utils.parseNumber(e),d=utils.parseNumber(d),p=utils.parseNumber(p),utils.anyIsError(e,d,p))return error.value;if(0>=e||0>=d||0>=p)return error.num;if(1>g||1>m||g>m)return error.num;if(0!==l&&1!==l)return error.num;var s=c.PMT(e,d,p,0,l),i=0;1===g&&0===l&&(i=-p,g++);for(var h=g;h<=m;h++)i+=1===l?c.FV(e,h-2,s,p,1)-s:c.FV(e,h-1,s,p,0);return i*=e},c.CUMPRINC=function(e,d,p,g,m,l){if(e=utils.parseNumber(e),d=utils.parseNumber(d),p=utils.parseNumber(p),utils.anyIsError(e,d,p))return error.value;if(0>=e||0>=d||0>=p)return error.num;if(1>g||1>m||g>m)return error.num;if(0!==l&&1!==l)return error.num;var s=c.PMT(e,d,p,0,l),i=0;1===g&&(i=0===l?s+p*e:s,g++);for(var h=g;h<=m;h++)i+=0<l?s-(c.FV(e,h-2,s,p,1)-s)*e:s-c.FV(e,h-1,s,p,0)*e;return i},c.DB=function(d,p,g,m,h){if(h=void 0===h?12:h,d=utils.parseNumber(d),p=utils.parseNumber(p),g=utils.parseNumber(g),m=utils.parseNumber(m),h=utils.parseNumber(h),utils.anyIsError(d,p,g,m,h))return error.value;if(0>d||0>p||0>g||0>m)return error.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(h))return error.num;if(m>g)return error.num;if(p>=d)return 0;for(var b=(1-_Mathpow(p/d,1/g)).toFixed(3),l=d*b*h/12,s=l,C=0,f=m===g?g-1:m,u=2;u<=f;u++)s+=C=(d-s)*b;return 1===m?l:m===g?(d-s)*b:C},c.DDB=function(a,d,u,c,p){if(p=void 0===p?2:p,a=utils.parseNumber(a),d=utils.parseNumber(d),u=utils.parseNumber(u),c=utils.parseNumber(c),p=utils.parseNumber(p),utils.anyIsError(a,d,u,c,p))return error.value;if(0>a||0>d||0>u||0>c||0>=p)return error.num;if(c>u)return error.num;if(d>=a)return 0;for(var g=0,m=0,h=1;h<=c;h++)g+=m=_Mathmin(p/u*(a-g),a-d-g);return m},c.DISC=null,c.DOLLARDE=function(s,l){if(s=utils.parseNumber(s),l=utils.parseNumber(l),utils.anyIsError(s,l))return error.value;if(0>l)return error.num;if(0<=l&&1>l)return error.div0;l=parseInt(l,10);var i=parseInt(s,10);i+=s%1*_Mathpow(10,_Mathceil(_Mathlog(l)/n))/l;var a=_Mathpow(10,_Mathceil(_Mathlog(l)/Math.LN2)+1);return i=_Mathround(i*a)/a},c.DOLLARFR=function(r,s){if(r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(r,s))return error.value;if(0>s)return error.num;if(0<=s&&1>s)return error.div0;s=parseInt(s,10);var l=parseInt(r,10);return l+=r%1*_Mathpow(10,-_Mathceil(_Mathlog(s)/n))*s},c.DURATION=null,c.EFFECT=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0>=n||1>r?error.num:(r=parseInt(r,10),_Mathpow(1+n/r,r)-1)},c.FV=function(i,a,d,u,c){if(u=u||0,c=c||0,i=utils.parseNumber(i),a=utils.parseNumber(a),d=utils.parseNumber(d),u=utils.parseNumber(u),c=utils.parseNumber(c),utils.anyIsError(i,a,d,u,c))return error.value;var p;if(0===i)p=u+d*a;else{var g=_Mathpow(1+i,a);p=1===c?u*g+d*(1+i)*(g-1)/i:u*g+d*(g-1)/i}return-p},c.FVSCHEDULE=function(s,l){if(s=utils.parseNumber(s),l=utils.parseNumberArray(utils.flatten(l)),utils.anyIsError(s,l))return error.value;for(var i=l.length,o=s,a=0;a<i;a++)o*=1+l[a];return o},c.INTRATE=null,c.IPMT=function(e,a,d,u,p,g){if(p=p||0,g=g||0,e=utils.parseNumber(e),a=utils.parseNumber(a),d=utils.parseNumber(d),u=utils.parseNumber(u),p=utils.parseNumber(p),g=utils.parseNumber(g),utils.anyIsError(e,a,d,u,p,g))return error.value;var m=c.PMT(e,d,u,p,g);return(1===a?1===g?0:-u:1===g?c.FV(e,a-2,m,u,1)-m:c.FV(e,a-1,m,u,0))*e},c.IRR=function(d,g){if(g=g||0,d=utils.parseNumberArray(utils.flatten(d)),g=utils.parseNumber(g),utils.anyIsError(d,g))return error.value;for(var m=function(r,e,t){for(var o=r[0],s=1;s<r.length;s++)o+=r[s]/_Mathpow(t+1,(e[s]-e[0])/365);return o},o=function(r,e,t){for(var o=0,i=1,a;i<r.length;i++)a=(e[i]-e[0])/365,o-=a*r[i]/_Mathpow(t+1,a+1);return o},r=[],n=!1,h=!1,C=0;C<d.length;C++)r[C]=0===C?0:r[C-1]+365,0<d[C]&&(n=!0),0>d[C]&&(h=!0);if(!n||!h)return error.num;var f=g=void 0===g?.1:g,y=!0,N,E,A;do N=f-(A=m(d,r,f))/o(d,r,f),E=_Mathabs(N-f),f=N,y=1e-10<E&&1e-10<_Mathabs(A);while(y);return f},c.ISPMT=function(n,s,l,i){return n=utils.parseNumber(n),s=utils.parseNumber(s),l=utils.parseNumber(l),i=utils.parseNumber(i),utils.anyIsError(n,s,l,i)?error.value:i*n*(s/l-1)},c.MDURATION=null,c.MIRR=function(e,d,p){if(e=utils.parseNumberArray(utils.flatten(e)),d=utils.parseNumber(d),p=utils.parseNumber(p),utils.anyIsError(e,d,p))return error.value;for(var g=e.length,n=[],l=[],s=0;s<g;s++)0>e[s]?n.push(e[s]):l.push(e[s]);var m=-c.NPV(p,l)*_Mathpow(1+p,g-1),a=c.NPV(d,n)*(1+d);return _Mathpow(m/a,1/(g-1))-1},c.NOMINAL=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0>=n||1>r?error.num:(r=parseInt(r,10),(_Mathpow(n+1,1/r)-1)*r)},c.NPER=function(i,a,d,u,c){if(c=void 0===c?0:c,u=void 0===u?0:u,i=utils.parseNumber(i),a=utils.parseNumber(a),d=utils.parseNumber(d),u=utils.parseNumber(u),c=utils.parseNumber(c),utils.anyIsError(i,a,d,u,c))return error.value;var p=a*(1+i*c)-u*i,l=d*i+a*(1+i*c);return _Mathlog(p/l)/_Mathlog(1+i)},c.NPV=function(){var n=utils.parseNumberArray(utils.flatten(arguments));if(n instanceof Error)return n;for(var e=n[0],t=0,s=1;s<n.length;s++)t+=n[s]/_Mathpow(1+e,s);return t},c.ODDFPRICE=null,c.ODDFYIELD=null,c.ODDLPRICE=null,c.ODDLYIELD=null,c.PDURATION=function(n,r,s){return n=utils.parseNumber(n),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0>=n?error.num:(_Mathlog(s)-_Mathlog(r))/_Mathlog(1+n)},c.PMT=function(i,a,d,u,c){if(u=u||0,c=c||0,i=utils.parseNumber(i),a=utils.parseNumber(a),d=utils.parseNumber(d),u=utils.parseNumber(u),c=utils.parseNumber(c),utils.anyIsError(i,a,d,u,c))return error.value;var p;if(0===i)p=(d+u)/a;else{var g=_Mathpow(1+i,a);p=1===c?(u*i/(g-1)+d*i/(1-1/g))/(1+i):u*i/(g-1)+d*i/(1-1/g)}return-p},c.PPMT=function(e,i,o,a,d,u){return d=d||0,u=u||0,e=utils.parseNumber(e),o=utils.parseNumber(o),a=utils.parseNumber(a),d=utils.parseNumber(d),u=utils.parseNumber(u),utils.anyIsError(e,o,a,d,u)?error.value:c.PMT(e,o,a,d,u)-c.IPMT(e,i,o,a,d,u)},c.PRICE=null,c.PRICEDISC=null,c.PRICEMAT=null,c.PV=function(s,l,i,a,d){return a=a||0,d=d||0,s=utils.parseNumber(s),l=utils.parseNumber(l),i=utils.parseNumber(i),a=utils.parseNumber(a),d=utils.parseNumber(d),utils.anyIsError(s,l,i,a,d)?error.value:0===s?-i*l-a:((1-_Mathpow(1+s,l))/s*i*(1+s*d)-a)/_Mathpow(1+s,l)},c.RATE=function(d,p,g,m,h,C){if(C=void 0===C?.01:C,m=void 0===m?0:m,h=void 0===h?0:h,d=utils.parseNumber(d),p=utils.parseNumber(p),g=utils.parseNumber(g),m=utils.parseNumber(m),h=utils.parseNumber(h),C=utils.parseNumber(C),utils.anyIsError(d,p,g,m,h,C))return error.value;for(var f=0,y=!1,N=C;100>f&&!y;){var E=_Mathpow(N+1,d),u=_Mathpow(N+1,d-1),c=N-(m+E*g+p*(E-1)*(N*h+1)/N)/(d*u*g-p*(E-1)*(N*h+1)/_Mathpow(N,2)+(d*p*u*(N*h+1)/N+p*(E-1)*h/N));1e-6>_Mathabs(c-N)&&(y=!0),f++,N=c}return y?N:Number.NaN+N},c.RECEIVED=null,c.RRI=function(n,r,s){return n=utils.parseNumber(n),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0===n||0===r?error.num:_Mathpow(s/r,1/n)-1},c.SLN=function(n,r,s){return n=utils.parseNumber(n),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0===s?error.num:(n-r)/s},c.SYD=function(n,s,l,i){return n=utils.parseNumber(n),s=utils.parseNumber(s),l=utils.parseNumber(l),i=utils.parseNumber(i),utils.anyIsError(n,s,l,i)?error.value:0===l?error.num:1>i||i>l?error.num:2*((n-s)*(l-(i=parseInt(i,10))+1))/(l*(l+1))},c.TBILLEQ=function(n,r,s){return n=utils.parseDate(n),r=utils.parseDate(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0>=s?error.num:n>r?error.num:31536e6<r-n?error.num:365*s/(360-s*DAYS360(n,r,!1))},c.TBILLPRICE=function(n,r,s){return n=utils.parseDate(n),r=utils.parseDate(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0>=s?error.num:n>r?error.num:31536e6<r-n?error.num:100*(1-s*DAYS360(n,r,!1)/360)},c.TBILLYIELD=function(n,r,s){return n=utils.parseDate(n),r=utils.parseDate(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0>=s?error.num:n>r?error.num:31536e6<r-n?error.num:360*(100-s)/(s*DAYS360(n,r,!1))},c.VDB=null,c.XIRR=function(d,g,m){if(d=utils.parseNumberArray(utils.flatten(d)),g=utils.parseDateArray(utils.flatten(g)),m=utils.parseNumber(m),utils.anyIsError(d,g,m))return error.value;for(var h=function(r,e,t){for(var o=r[0],s=1;s<r.length;s++)o+=r[s]/_Mathpow(t+1,DAYS(e[s],e[0])/365);return o},r=function(r,e,t){for(var o=0,i=1,a;i<r.length;i++)a=DAYS(e[i],e[0])/365,o-=a*r[i]/_Mathpow(t+1,a+1);return o},n=!1,C=!1,f=0;f<d.length;f++)0<d[f]&&(n=!0),0>d[f]&&(C=!0);if(!n||!C)return error.num;var y=m=m||.1,N=!0,E,A,w;do E=y-(w=h(d,g,y))/r(d,g,y),A=_Mathabs(E-y),y=E,N=1e-10<A&&1e-10<_Mathabs(w);while(N);return y},c.XNPV=function(s,l,i){if(s=utils.parseNumber(s),l=utils.parseNumberArray(utils.flatten(l)),i=utils.parseDateArray(utils.flatten(i)),utils.anyIsError(s,l,i))return error.value;for(var a=0,d=0;d<l.length;d++)a+=l[d]/_Mathpow(1+s,DAYS(i[d],i[0])/365);return a},c.YIELD=null,c.YIELDDISC=null,c.YIELDMAT=null,c}(),jexcel.methods.information=function(){var n={CELL:null,ERROR:{}};return n.ERROR.TYPE=function(t){return t===error.nil?1:t===error.div0?2:t===error.value?3:t===error.ref?4:t===error.name?5:t===error.num?6:t===error.na?7:t===error.data?8:error.na},n.INFO=null,n.ISBLANK=function(t){return null===t},n.ISBINARY=function(t){return /^[01]{1,10}$/.test(t)},n.ISERR=function(t){return 0<=[error.value,error.ref,error.div0,error.num,error.name,error.nil].indexOf(t)||"number"==typeof t&&(isNaN(t)||!isFinite(t))},n.ISERROR=function(e){return n.ISERR(e)||e===error.na},n.ISEVEN=function(t){return!(1&_Mathfloor(_Mathabs(t)))},n.ISFORMULA=null,n.ISLOGICAL=function(t){return!0===t||!1===t},n.ISNA=function(t){return t===error.na},n.ISNONTEXT=function(t){return"string"!=typeof t},n.ISNUMBER=function(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)},n.ISODD=function(t){return!!(1&_Mathfloor(_Mathabs(t)))},n.ISREF=null,n.ISTEXT=function(t){return"string"==typeof t},n.N=function(t){return this.ISNUMBER(t)?t:t instanceof Date?t.getTime():!0===t?1:!1===t?0:this.ISERROR(t)?t:0},n.NA=function(){return error.na},n.SHEET=null,n.SHEETS=null,n.TYPE=function(t){return this.ISNUMBER(t)?1:this.ISTEXT(t)?2:this.ISLOGICAL(t)?4:this.ISERROR(t)?16:Array.isArray(t)?64:void 0},n}(),jexcel.methods.logical=function(){return{AND:function(){for(var n=utils.flatten(arguments),e=!0,r=0;r<n.length;r++)n[r]||(e=!1);return e},CHOOSE:function(){if(2>arguments.length)return error.na;var t=arguments[0];return 1>t||254<t?error.value:arguments.length<t+1?error.value:arguments[t]},FALSE:function(){return!1},IF:function(n,e,t){return n?e:t},IFERROR:function(n,e){return ISERROR(n)?e:n},IFNA:function(n,e){return n===error.na?e:n},NOT:function(t){return!t},OR:function(){for(var n=utils.flatten(arguments),e=!1,r=0;r<n.length;r++)n[r]&&(e=!0);return e},TRUE:function(){return!0},XOR:function(){for(var n=utils.flatten(arguments),e=0,r=0;r<n.length;r++)n[r]&&e++;return!!(1&_Mathfloor(_Mathabs(e)))},SWITCH:function(){var i;if(0<arguments.length){var a=arguments[0],t=arguments.length-1,o=_Mathfloor(t/2),r=!1,d=0==t%2?null:arguments[arguments.length-1];if(o)for(var l=0;l<o;l++)if(a===arguments[2*l+1]){i=arguments[2*l+2],r=!0;break}!r&&d&&(i=d)}return i}}}(),jexcel.methods.math=function(){var _Mathtan=Math.tan,exports={ABS:function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathabs(utils.parseNumber(t))},ACOS:function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.acos(t)},ACOSH:function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathlog(t+_Mathsqrt(t*t-1))},ACOT:function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathatan(1/t)},ACOTH:function(t){return(t=utils.parseNumber(t))instanceof Error?t:.5*_Mathlog((t+1)/(t-1))},AGGREGATE:null,ARABIC:function(n){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(n))return error.value;var r=0;return n.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(t){r+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),r},ASIN:function(t){return(t=utils.parseNumber(t))instanceof Error?t:Math.asin(t)},ASINH:function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathlog(t+_Mathsqrt(t*t+1))},ATAN:function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathatan(t)},ATAN2:function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:Math.atan2(n,r)},ATANH:function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathlog((1+t)/(1-t))/2},BASE:function(n,s,l){if(l=l||0,n=utils.parseNumber(n),s=utils.parseNumber(s),l=utils.parseNumber(l),utils.anyIsError(n,s,l))return error.value;l=void 0===l?0:l;var i=n.toString(s);return Array(_Mathmax(l+1-i.length,0)).join("0")+i},CEILING:function(n,r,s){return r=void 0===r?1:r,s=void 0===s?0:s,n=utils.parseNumber(n),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0===r?0:(r=_Mathabs(r),0<=n?_Mathceil(n/r)*r:0===s?-1*_Mathfloor(_Mathabs(n)/r)*r:-1*_Mathceil(_Mathabs(n)/r)*r)}};exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:exports.FACT(n)/(exports.FACT(r)*exports.FACT(n-r))},exports.COMBINA=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0===n&&0===r?1:exports.COMBIN(n+r-1,n-1)},exports.COS=function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathcos(t)},exports.COSH=function(t){return(t=utils.parseNumber(t))instanceof Error?t:(_Mathexp(t)+_Mathexp(-t))/2},exports.COT=function(t){return(t=utils.parseNumber(t))instanceof Error?t:1/_Mathtan(t)},exports.COTH=function(n){if((n=utils.parseNumber(n))instanceof Error)return n;var r=_Mathexp(2*n);return(r+1)/(r-1)},exports.CSC=function(t){return(t=utils.parseNumber(t))instanceof Error?t:1/_Mathsin(t)},exports.CSCH=function(t){return(t=utils.parseNumber(t))instanceof Error?t:2/(_Mathexp(t)-_Mathexp(-t))},exports.DECIMAL=function(n,e){return 1>arguments.length?error.value:parseInt(n,e)},exports.DEGREES=function(t){return(t=utils.parseNumber(t))instanceof Error?t:180*t/_MathPI},exports.EVEN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:exports.CEILING(t,-2,-1)},exports.EXP=_Mathexp;var MEMOIZED_FACT=[];return exports.FACT=function(n){if((n=utils.parseNumber(n))instanceof Error)return n;var r=_Mathfloor(n);return 0===r||1===r?1:0<MEMOIZED_FACT[r]?MEMOIZED_FACT[r]:(MEMOIZED_FACT[r]=exports.FACT(r-1)*r,MEMOIZED_FACT[r])},exports.FACTDOUBLE=function(n){if((n=utils.parseNumber(n))instanceof Error)return n;var r=_Mathfloor(n);return 0>=r?1:r*exports.FACTDOUBLE(r-2)},exports.FLOOR=function(n,r,s){return r=void 0===r?1:r,s=void 0===s?0:s,n=utils.parseNumber(n),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:0===r?0:(r=_Mathabs(r),0<=n?_Mathfloor(n/r)*r:0===s?-1*_Mathceil(_Mathabs(n)/r)*r:-1*_Mathfloor(_Mathabs(n)/r)*r)},exports.FLOOR.MATH=exports.FLOOR,exports.GCD=null,exports.INT=function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathfloor(t)},exports.LCM=function(){var s=utils.parseNumberArray(utils.flatten(arguments));if(s instanceof Error)return s;for(var e=1,i,a,d,u;void 0!==(d=s.pop());)for(;1<d;){if(d%2){for(i=3,a=_Mathfloor(_Mathsqrt(d));i<=a&&d%i;i+=2);u=i<=a?i:d}else u=2;for(d/=u,e*=u,i=s.length;i;0==s[--i]%u&&1==(s[i]/=u)&&s.splice(i,1));}return e},exports.LN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathlog(t)},exports.LOG=function(n,r){return n=utils.parseNumber(n),r=void 0===r?10:utils.parseNumber(r),utils.anyIsError(n,r)?error.value:_Mathlog(n)/_Mathlog(r)},exports.LOG10=function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathlog(t)/_Mathlog(10)},exports.MDETERM=null,exports.MINVERSE=null,exports.MMULT=null,exports.MOD=function(n,r){if(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r))return error.value;if(0===r)return error.div0;var s=_Mathabs(n%r);return 0<r?s:-s},exports.MROUND=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0>n*r?error.num:_Mathround(n/r)*r},exports.MULTINOMIAL=function(){var n=utils.parseNumberArray(utils.flatten(arguments));if(n instanceof Error)return n;for(var e=0,s=1,l=0;l<n.length;l++)e+=n[l],s*=exports.FACT(n[l]);return exports.FACT(e)/s},exports.MUNIT=null,exports.ODD=function(n){if((n=utils.parseNumber(n))instanceof Error)return n;var r=_Mathceil(_Mathabs(n));return r=1&r?r:r+1,0<n?r:-r},exports.PI=function(){return _MathPI},exports.POWER=function(n,r){if(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r))return error.value;var s=_Mathpow(n,r);return isNaN(s)?error.num:s},exports.PRODUCT=function(){var n=utils.parseNumberArray(utils.flatten(arguments));if(n instanceof Error)return n;for(var e=1,r=0;r<n.length;r++)e*=n[r];return e},exports.QUOTIENT=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:parseInt(n/r,10)},exports.RADIANS=function(t){return(t=utils.parseNumber(t))instanceof Error?t:t*_MathPI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:n+_Mathceil((r-n+1)*Math.random())-1},exports.ROMAN=null,exports.ROUND=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:_Mathround(n*_Mathpow(10,r))/_Mathpow(10,r)},exports.ROUNDDOWN=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:(0<n?1:-1)*_Mathfloor(_Mathabs(n)*_Mathpow(10,r))/_Mathpow(10,r)},exports.ROUNDUP=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:(0<n?1:-1)*_Mathceil(_Mathabs(n)*_Mathpow(10,r))/_Mathpow(10,r)},exports.SEC=function(t){return(t=utils.parseNumber(t))instanceof Error?t:1/_Mathcos(t)},exports.SECH=function(t){return(t=utils.parseNumber(t))instanceof Error?t:2/(_Mathexp(t)+_Mathexp(-t))},exports.SERIESSUM=function(s,i,a,d){if(s=utils.parseNumber(s),i=utils.parseNumber(i),a=utils.parseNumber(a),d=utils.parseNumberArray(d),utils.anyIsError(s,i,a,d))return error.value;for(var u=d[0]*_Mathpow(s,i),c=1;c<d.length;c++)u+=d[c]*_Mathpow(s,i+c*a);return u},exports.SIGN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:0>t?-1:0===t?0:1},exports.SIN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathsin(t)},exports.SINH=function(t){return(t=utils.parseNumber(t))instanceof Error?t:(_Mathexp(t)-_Mathexp(-t))/2},exports.SQRT=function(t){return(t=utils.parseNumber(t))instanceof Error?t:0>t?error.num:_Mathsqrt(t)},exports.SQRTPI=function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathsqrt(t*_MathPI)},exports.SUBTOTAL=null,exports.ADD=function(n,r){return 2===arguments.length?(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:n+r):error.na},exports.MINUS=function(n,r){return 2===arguments.length?(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:n-r):error.na},exports.DIVIDE=function(n,r){return 2===arguments.length?(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:0===r?error.div0:n/r):error.na},exports.MULTIPLY=function(n,r){return 2===arguments.length?(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:n*r):error.na},exports.GTE=function(n,r){return 2===arguments.length?(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.error:n>=r):error.na},exports.LT=function(n,r){return 2===arguments.length?(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.error:n<r):error.na},exports.LTE=function(n,r){return 2===arguments.length?(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.error:n<=r):error.na},exports.EQ=function(n,e){return 2===arguments.length?n===e:error.na},exports.NE=function(n,e){return 2===arguments.length?n!==e:error.na},exports.POW=function(n,r){return 2===arguments.length?(n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.error:exports.POWER(n,r)):error.na},exports.SUM=function(){for(var s=0,l=Object.keys(arguments),t=0,i;t<l.length;++t)if(i=arguments[l[t]],"number"==typeof i)s+=i;else if("string"==typeof i){var a=parseFloat(i);isNaN(a)||(s+=a)}else Array.isArray(i)&&(s+=exports.SUM.apply(null,i));return s},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=null,exports.SUMSQ=function(){var n=utils.parseNumberArray(utils.flatten(arguments));if(n instanceof Error)return n;for(var e=0,s=n.length,o=0;o<s;o++)e+=ISNUMBER(n[o])?n[o]*n[o]:0;return e},exports.SUMX2MY2=function(n,s){if(n=utils.parseNumberArray(utils.flatten(n)),s=utils.parseNumberArray(utils.flatten(s)),utils.anyIsError(n,s))return error.value;for(var l=0,i=0;i<n.length;i++)l+=n[i]*n[i]-s[i]*s[i];return l},exports.SUMX2PY2=function(n,s){if(n=utils.parseNumberArray(utils.flatten(n)),s=utils.parseNumberArray(utils.flatten(s)),utils.anyIsError(n,s))return error.value;var l=0;n=utils.parseNumberArray(utils.flatten(n)),s=utils.parseNumberArray(utils.flatten(s));for(var i=0;i<n.length;i++)l+=n[i]*n[i]+s[i]*s[i];return l},exports.SUMXMY2=function(n,s){if(n=utils.parseNumberArray(utils.flatten(n)),s=utils.parseNumberArray(utils.flatten(s)),utils.anyIsError(n,s))return error.value;var l=0;n=utils.flatten(n),s=utils.flatten(s);for(var i=0;i<n.length;i++)l+=_Mathpow(n[i]-s[i],2);return l},exports.TAN=function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathtan(t)},exports.TANH=function(n){if((n=utils.parseNumber(n))instanceof Error)return n;var r=_Mathexp(2*n);return(r-1)/(r+1)},exports.TRUNC=function(n,r){return r=void 0===r?0:r,n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:(0<n?1:-1)*_Mathfloor(_Mathabs(n)*_Mathpow(10,r))/_Mathpow(10,r)},exports}(),jexcel.methods.misc=function(){var t={UNIQUE:function(){for(var s=[],e=0;e<arguments.length;++e){for(var l=!1,i=arguments[e],r=0;r<s.length&&!(l=s[r]===i);++r);l||s.push(i)}return s}};return t.FLATTEN=utils.flatten,t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},t.REFERENCE=function(a,e){try{for(var t=e.split("."),o=a,d=0,u;d<t.length;++d)if(u=t[d],"]"===u[u.length-1]){var c=u.indexOf("["),s=u.substring(c+1,u.length-1);o=o[u.substring(0,c)][s]}else o=o[u];return o}catch(t){}},t.JOIN=function(n,e){return n.join(e)},t.NUMBERS=function(){return utils.flatten(arguments).filter(function(t){return"number"==typeof t})},t.NUMERAL=null,t}(),jexcel.methods.text=function(){var t={ASC:null,BAHTTEXT:null,CHAR:function(t){return(t=utils.parseNumber(t))instanceof Error?t:_StringfromCharCode(t)},CLEAN:function(t){return(t=t||"").replace(/[\0-\x1F]/g,"")},CODE:function(t){return(t=t||"").charCodeAt(0)},CONCATENATE:function(){for(var n=utils.flatten(arguments),e=0;-1<(e=n.indexOf(!0));)n[e]="TRUE";for(var r=0;-1<(r=n.indexOf(!1));)n[r]="FALSE";return n.join("")},DBCS:null,DOLLAR:null,EXACT:function(n,e){return n===e},FIND:function(n,e,t){return t=void 0===t?0:t,e?e.indexOf(n,t-1)+1:null},FIXED:null,HTML2TEXT:function(n){var r="";return n&&(n instanceof Array?n.forEach(function(t){""!==r&&(r+="\n"),r+=t.replace(/<(?:.|\n)*?>/gm,"")}):r=n.replace(/<(?:.|\n)*?>/gm,"")),r},LEFT:function(n,e){return e=void 0===e?1:e,(e=utils.parseNumber(e))instanceof Error||"string"!=typeof n?error.value:n?n.substring(0,e):null},LEN:function(t){return 0===arguments.length?error.error:"string"==typeof t?t?t.length:0:t.length?t.length:error.value},LOWER:function(t){return"string"==typeof t?t?t.toLowerCase():t:error.value},MID:function(s,e,l){if(e=utils.parseNumber(e),l=utils.parseNumber(l),utils.anyIsError(e,l)||"string"!=typeof s)return l;var i=e-1,r=i+l;return s.substring(i,r)},NUMBERVALUE:null,PRONETIC:null,PROPER:function(t){return void 0===t||0===t.length?error.value:(!0===t&&(t="TRUE"),!1===t&&(t="FALSE"),isNaN(t)&&"number"==typeof t?error.value:("number"==typeof t&&(t=""+t),t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})))},REGEXEXTRACT:function(n,e){var t=n.match(new RegExp(e));return t?t[1<t.length?t.length-1:0]:null},REGEXMATCH:function(n,e,t){var o=n.match(new RegExp(e));return t?o:!!o},REGEXREPLACE:function(n,e,t){return n.replace(new RegExp(e),t)},REPLACE:function(n,e,s,l){return e=utils.parseNumber(e),s=utils.parseNumber(s),utils.anyIsError(e,s)||"string"!=typeof n||"string"!=typeof l?error.value:n.substr(0,e-1)+l+n.substr(e-1+s)},REPT:function(n,e){return(e=utils.parseNumber(e))instanceof Error?e:Array(e+1).join(n)},RIGHT:function(n,e){return e=void 0===e?1:e,(e=utils.parseNumber(e))instanceof Error?e:n?n.substring(n.length-e):null},SEARCH:function(n,e,t){var s;return"string"!=typeof n||"string"!=typeof e?error.value:(t=void 0===t?0:t,0===(s=e.toLowerCase().indexOf(n.toLowerCase(),t-1)+1)?error.value:s)},SPLIT:function(n,e){return n.split(e)},SUBSTITUTE:function(s,e,t,o){if(!(s&&e&&t))return s;if(void 0===o)return s.replace(new RegExp(e,"g"),t);for(var r=0,i=0;0<s.indexOf(e,r);)if(r=s.indexOf(e,r+1),++i===o)return s.substring(0,r)+t+s.substring(r+e.length)},T:function(t){return"string"==typeof t?t:""},TEXT:null,TRIM:function(t){return"string"==typeof t?t.replace(/ +/g," ").trim():error.value}};return t.UNICHAR=t.CHAR,t.UNICODE=t.CODE,t.UPPER=function(t){return"string"==typeof t?t.toUpperCase():error.value},t.VALUE=null,t}(),jexcel.methods.stats=function(){var exports={},SQRT2PI=2.5066282746310002;return exports.AVEDEV=null,exports.AVERAGE=function(){for(var s=utils.numbers(utils.flatten(arguments)),e=s.length,t=0,l=0,i=0;i<e;i++)t+=s[i],l+=1;return t/l},exports.AVERAGEA=function(){for(var s=utils.flatten(arguments),e=s.length,t=0,i=0,a=0,d;a<e;a++)d=s[a],"number"==typeof d&&(t+=d),!0===d&&t++,null!==d&&i++;return t/i},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=null,exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var t=utils.flatten(arguments);return t.length-exports.COUNTBLANK(t)},exports.COUNTIN=function(n,e){for(var t=0,s=0;s<n.length;s++)n[s]===e&&t++;return t},exports.COUNTBLANK=function(){for(var n=utils.flatten(arguments),t=0,s=0,l;s<n.length;s++)null!==(l=n[s])&&""!==l||t++;return t},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria="==\""+criteria+"\"");for(var matches=0,i=0;i<range.length;i++)"string"==typeof range[i]?eval("\""+range[i]+"\""+criteria)&&matches++:eval(range[i]+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria="==\""+criteria+"\"");for(var j=0;j<range.length;j++)results[j]="string"==typeof range[j]?results[j]&&eval("\""+range[j]+"\""+criteria):results[j]&&eval(range[j]+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return UNIQUE.apply(null,utils.flatten(arguments)).length},exports.FISHER=function(t){return(t=utils.parseNumber(t))instanceof Error?t:_Mathlog((1+t)/(1-t))/2},exports.FISHERINV=function(n){if((n=utils.parseNumber(n))instanceof Error)return n;var r=_Mathexp(2*n);return(r-1)/(r+1)},exports.FREQUENCY=function(i,a){if(i=utils.parseNumberArray(utils.flatten(i)),a=utils.parseNumberArray(utils.flatten(a)),utils.anyIsError(i,a))return error.value;for(var d=i.length,o=a.length,r=[],n=0;n<=o;n++){r[n]=0;for(var u=0;u<d;u++)0===n?i[u]<=a[0]&&(r[0]+=1):n<o?i[u]>a[n-1]&&i[u]<=a[n]&&(r[n]+=1):n===o&&i[u]>a[o-1]&&(r[o]+=1)}return r},exports.LARGE=function(n,r){return n=utils.parseNumberArray(utils.flatten(n)),r=utils.parseNumber(r),utils.anyIsError(n,r)?n:n.sort(function(n,e){return e-n})[r-1]},exports.MAX=function(){var t=utils.numbers(utils.flatten(arguments));return 0===t.length?0:_Mathmax.apply(Math,t)},exports.MAXA=function(){var t=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===t.length?0:_Mathmax.apply(Math,t)},exports.MIN=function(){var t=utils.numbers(utils.flatten(arguments));return 0===t.length?0:_Mathmin.apply(Math,t)},exports.MINA=function(){var t=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===t.length?0:_Mathmin.apply(Math,t)},exports.MODE={},exports.MODE.MULT=function(){var i=utils.parseNumberArray(utils.flatten(arguments));if(i instanceof Error)return i;for(var e=i.length,o={},r=[],a=0,d=0,u;d<e;d++)o[u=i[d]]=o[u]?o[u]+1:1,o[u]>a&&(a=o[u],r=[]),o[u]===a&&(r[r.length]=u);return r},exports.MODE.SNGL=function(){var t=utils.parseNumberArray(utils.flatten(arguments));return t instanceof Error?t:exports.MODE.MULT(t).sort(function(n,e){return n-e})[0]},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(s,l){if(s=utils.parseNumberArray(utils.flatten(s)),l=utils.parseNumber(l),utils.anyIsError(s,l))return error.value;var i=(s=s.sort(function(n,e){return n-e})).length;if(l<1/(i+1)||l>1-1/(i+1))return error.num;var o=l*(i+1)-1,r=_Mathfloor(o);return utils.cleanFloat(o===r?s[o]:s[r]+(o-r)*(s[r+1]-s[r]))},exports.PERCENTILE.INC=function(n,s){if(n=utils.parseNumberArray(utils.flatten(n)),s=utils.parseNumber(s),utils.anyIsError(n,s))return error.value;var l=s*((n=n.sort(function(n,e){return n-e})).length-1),o=_Mathfloor(l);return utils.cleanFloat(l===o?n[l]:n[o]+(l-o)*(n[o+1]-n[o]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(d,c,p){if(p=void 0===p?3:p,d=utils.parseNumberArray(utils.flatten(d)),c=utils.parseNumber(c),p=utils.parseNumber(p),utils.anyIsError(d,c,p))return error.value;d=d.sort(function(n,e){return n-e});for(var g=UNIQUE.apply(null,d),r=d.length,n=g.length,l=_Mathpow(10,p),s=0,m=!1,h=0;!m&&h<n;)c===g[h]?(s=(d.indexOf(g[h])+1)/(r+1),m=!0):c>=g[h]&&(c<g[h+1]||h===n-1)&&(s=(d.indexOf(g[h])+1+(c-g[h])/(g[h+1]-g[h]))/(r+1),m=!0),h++;return _Mathfloor(s*l)/l},exports.PERCENTRANK.INC=function(d,c,p){if(p=void 0===p?3:p,d=utils.parseNumberArray(utils.flatten(d)),c=utils.parseNumber(c),p=utils.parseNumber(p),utils.anyIsError(d,c,p))return error.value;d=d.sort(function(n,e){return n-e});for(var g=UNIQUE.apply(null,d),r=d.length,n=g.length,l=_Mathpow(10,p),s=0,m=!1,h=0;!m&&h<n;)c===g[h]?(s=d.indexOf(g[h])/(r-1),m=!0):c>=g[h]&&(c<g[h+1]||h===n-1)&&(s=(d.indexOf(g[h])+(c-g[h])/(g[h+1]-g[h]))/(r-1),m=!0),h++;return _Mathfloor(s*l)/l},exports.PERMUT=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:FACT(n)/FACT(n-r)},exports.PERMUTATIONA=function(n,r){return n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(n,r)?error.value:_Mathpow(n,r)},exports.PHI=function(t){return(t=utils.parseNumber(t))instanceof Error?error.value:_Mathexp(-.5*t*t)/SQRT2PI},exports.PROB=function(a,d,u,c){if(void 0===u)return 0;if(c=void 0===c?u:c,a=utils.parseNumberArray(utils.flatten(a)),d=utils.parseNumberArray(utils.flatten(d)),u=utils.parseNumber(u),c=utils.parseNumber(c),utils.anyIsError(a,d,u,c))return error.value;if(u===c)return 0<=a.indexOf(u)?d[a.indexOf(u)]:0;for(var p=a.sort(function(n,e){return n-e}),n=p.length,l=0,g=0;g<n;g++)p[g]>=u&&p[g]<=c&&(l+=d[a.indexOf(p[g])]);return l},exports.QUARTILE={},exports.QUARTILE.EXC=function(n,r){if(n=utils.parseNumberArray(utils.flatten(n)),r=utils.parseNumber(r),utils.anyIsError(n,r))return error.value;return 1===r?exports.PERCENTILE.EXC(n,.25):2===r?exports.PERCENTILE.EXC(n,.5):3===r?exports.PERCENTILE.EXC(n,.75):error.num},exports.QUARTILE.INC=function(n,r){if(n=utils.parseNumberArray(utils.flatten(n)),r=utils.parseNumber(r),utils.anyIsError(n,r))return error.value;return 1===r?exports.PERCENTILE.INC(n,.25):2===r?exports.PERCENTILE.INC(n,.5):3===r?exports.PERCENTILE.INC(n,.75):error.num},exports.RANK={},exports.RANK.AVG=function(i,a,d){if(i=utils.parseNumber(i),a=utils.parseNumberArray(utils.flatten(a)),utils.anyIsError(i,a))return error.value;for(var u=(d=d||!1)?function(n,e){return n-e}:function(n,e){return e-n},r=(a=(a=utils.flatten(a)).sort(u)).length,n=0,c=0;c<r;c++)a[c]===i&&n++;return 1<n?(2*a.indexOf(i)+n+1)/2:a.indexOf(i)+1},exports.RANK.EQ=function(n,s,l){if(n=utils.parseNumber(n),s=utils.parseNumberArray(utils.flatten(s)),utils.anyIsError(n,s))return error.value;var i=(l=l||!1)?function(n,e){return n-e}:function(n,e){return e-n};return(s=s.sort(i)).indexOf(n)+1},exports.RSQ=function(n,r){return n=utils.parseNumberArray(utils.flatten(n)),r=utils.parseNumberArray(utils.flatten(r)),utils.anyIsError(n,r)?error.value:_Mathpow(exports.PEARSON(n,r),2)},exports.SMALL=function(n,r){return n=utils.parseNumberArray(utils.flatten(n)),r=utils.parseNumber(r),utils.anyIsError(n,r)?n:n.sort(function(n,e){return n-e})[r-1]},exports.STANDARDIZE=function(n,r,s){return n=utils.parseNumber(n),r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(n,r,s)?error.value:(n-r)/s},exports.STDEV={},exports.STDEV.P=function(){var t=exports.VAR.P.apply(this,arguments);return _Mathsqrt(t)},exports.STDEV.S=function(){var t=exports.VAR.S.apply(this,arguments);return _Mathsqrt(t)},exports.STDEVA=function(){var t=exports.VARA.apply(this,arguments);return _Mathsqrt(t)},exports.STDEVPA=function(){var t=exports.VARPA.apply(this,arguments);return _Mathsqrt(t)},exports.VAR={},exports.VAR.P=function(){for(var s=utils.numbers(utils.flatten(arguments)),e=s.length,t=0,l=exports.AVERAGE(s),r=0;r<e;r++)t+=_Mathpow(s[r]-l,2);return t/e},exports.VAR.S=function(){for(var s=utils.numbers(utils.flatten(arguments)),e=s.length,t=0,l=exports.AVERAGE(s),r=0;r<e;r++)t+=_Mathpow(s[r]-l,2);return t/(e-1)},exports.VARA=function(){for(var i=utils.flatten(arguments),e=i.length,t=0,a=0,d=exports.AVERAGEA(i),n=0,u;n<e;n++)u=i[n],t+="number"==typeof u?_Mathpow(u-d,2):!0===u?_Mathpow(1-d,2):_Mathpow(0-d,2),null!==u&&a++;return t/(a-1)},exports.VARPA=function(){for(var i=utils.flatten(arguments),e=i.length,t=0,a=0,d=exports.AVERAGEA(i),n=0,u;n<e;n++)u=i[n],t+="number"==typeof u?_Mathpow(u-d,2):!0===u?_Mathpow(1-d,2):_Mathpow(0-d,2),null!==u&&a++;return t/a},exports.WEIBULL={},exports.WEIBULL.DIST=function(n,s,l,i){return n=utils.parseNumber(n),s=utils.parseNumber(s),l=utils.parseNumber(l),utils.anyIsError(n,s,l)?error.value:i?1-_Mathexp(-_Mathpow(n/l,s)):_Mathpow(n,s-1)*_Mathexp(-_Mathpow(n/l,s))*s/_Mathpow(l,s)},exports.Z={},exports.Z.TEST=function(n,s,l){if(n=utils.parseNumberArray(utils.flatten(n)),s=utils.parseNumber(s),utils.anyIsError(n,s))return error.value;l=l||exports.STDEV.S(n);var i=n.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(n)-s)/(l/_Mathsqrt(i)),!0)},exports}();for(var i=0;i<Object.keys(jexcel.methods).length;i++)for(var methods=jexcel.methods[Object.keys(jexcel.methods)[i]],j=0;j<Object.keys(methods).length;j++)window[Object.keys(methods)[j]]="function"==typeof methods[Object.keys(methods)[j]]?methods[Object.keys(methods)[j]]:function(){return Object.keys(methods)[j]+"Not implemented"};return jexcel});